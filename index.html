<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß IPTV Control Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .auth-container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            margin: 100px auto;
        }
        .auth-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .hidden { display: none !important; }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background: #007bff;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .control-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #0056b3; }
        .btn-danger { background: #dc3545; }
        .btn-danger:hover { background: #c82333; }
        .btn-success { background: #28a745; }
        .btn-success:hover { background: #218838; }
        .status-indicator {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin: 5px;
        }
        .online { background: #d4edda; color: #155724; }
        .offline { background: #f8d7da; color: #721c24; }
        .service-status-big {
            background: #f8f9fa;
            border: 3px solid #28a745;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }
        .service-status-big.offline {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }
        .service-status-big.online {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
        .service-status-big.changed {
            animation: statusChange 1s ease-in-out;
        }
        @keyframes statusChange {
            0% { transform: scale(1); box-shadow: none; }
            50% { transform: scale(1.02); box-shadow: 0 0 20px rgba(0,0,0,0.3); }
            100% { transform: scale(1); box-shadow: none; }
        }
        textarea {
            width: 100%;
            height: 200px;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            box-sizing: border-box;
        }
        input[type="file"] {
            margin: 10px 0;
        }
        .log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            height: 200px;
            overflow-y: auto;
        }
        .api-endpoint {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
        }
        code { background: #e9ecef; padding: 2px 5px; border-radius: 3px; }
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #dee2e6;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .device-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            transition: box-shadow 0.2s ease;
        }
        .device-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .device-name {
            font-weight: bold;
            font-size: 16px;
            color: #333;
        }
        .device-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .device-status.online {
            background: #d4edda;
            color: #155724;
        }
        .device-status.offline {
            background: #f8d7da;
            color: #721c24;
        }
        .device-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 10px 0;
            font-size: 13px;
            color: #666;
        }
        .device-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .device-toggle {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }
        .device-toggle.enabled {
            background: #28a745;
            color: white;
        }
        .device-toggle.disabled {
            background: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <div id="auth-container" class="auth-container">
        <h1>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
        <p>–í–≤–µ–¥–∏—Ç–µ GitHub Personal Access Token –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</p>
        <input type="password" id="auth-token" class="auth-input" placeholder="GitHub Personal Access Token" autocomplete="off">
        <button class="btn btn-success" onclick="authenticate()" style="width: 100%; margin-top: 10px;">üîì –í–æ–π—Ç–∏</button>
        <div id="auth-error" style="color: red; margin-top: 10px; display: none;"></div>
        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; font-size: 12px; text-align: left;">
            <strong>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω:</strong><br>
            1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ <a href="https://github.com/settings/tokens" target="_blank">GitHub Settings ‚Üí Tokens</a><br>
            2. –°–æ–∑–¥–∞–π—Ç–µ Personal Access Token<br>
            3. –í—ã–±–µ—Ä–∏—Ç–µ scopes: <code>repo</code>, <code>workflow</code><br>
            4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏ –≤–≤–µ–¥–∏—Ç–µ –≤—ã—à–µ
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Å–∫—Ä—ã—Ç –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) -->
    <div id="main-content" class="hidden">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç–∞—Ç—É—Å -->
        <div class="container">
            <h1>üîß IPTV Control Panel</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è IPTV –∫–∞–Ω–∞–ª–∞–º–∏ –¥–ª—è Android TV</p>
            <div style="text-align: right;">
                <button class="btn btn-danger" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>
            <div id="service-status"></div>
        </div>

    <!-- –¢–∞–±—ã -->
    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showTab('public')">üìä –ü—É–±–ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
            <button class="tab" onclick="showTab('admin')">üîß –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ü—É–±–ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div id="public" class="tab-content active">
            <h2>üìã API Endpoints</h2>
            
            <div class="api-endpoint">
                <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h3>
                <code>GET /api/config.json</code>
                <p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å—Ç–∞—Ç—É—Å–µ —Å–µ—Ä–≤–∏—Å–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–∞–Ω–∞–ª–æ–≤</p>
            </div>
            
            <div class="api-endpoint">
                <h3>–°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤</h3>
                <code>GET /files/channels.m3u8</code>
                <p>–ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ IPTV –∫–∞–Ω–∞–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ M3U8</p>
            </div>
            
            <div class="api-endpoint">
                <h3>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                <code>GET /files/security_config.xml</code>
                <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è Android</p>
            </div>
            
            <h2>üì± –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</h2>
            <p>–ë–∞–∑–æ–≤—ã–π URL: <code>https://artemon4es.github.io/tv-channels-api</code></p>
            <p>API –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</p>
            
            <h2>üîß –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            <div id="system-status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <button onclick="loadCurrentConfig()" style="margin-top: 10px; background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
            </button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ -->
        <div id="admin" class="tab-content">
            <div class="control-panel">
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º -->
                <div class="section">
                    <h3>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º</h3>
                    <div id="admin-service-status" class="service-status-big">
                        üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...
                    </div>
                    <button class="btn btn-success" onclick="enableService()">‚úÖ –í–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å</button>
                    <button class="btn btn-danger" onclick="disableService()">‚ùå –û—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å</button>
                    <button class="btn" onclick="loadCurrentConfig()" style="background: #6c757d;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                    <br><br>
                    <div style="padding: 15px; background: #f0f8ff; border-radius: 5px; border-left: 4px solid #007bff;">
                        <p style="margin: 0; font-size: 14px; color: #0056b3;">
                            <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:<br>
                            <em>"–°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."</em>
                        </p>
                    </div>
                    <div style="padding: 15px; background: #fff3cd; border-radius: 5px; border-left: 4px solid #ffc107; margin-top: 10px;">
                        <p style="margin: 0; font-size: 14px; color: #856404;">
                            <strong>‚ö†Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ GitHub Pages:</strong> –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ 10 –º–∏–Ω—É—Ç –∏–∑-–∑–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è GitHub Pages. –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –Ω–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
                        </p>
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏ -->
                <div class="section">
                    <h3>üì∫ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏</h3>
                    
                    <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ -->
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #007bff;">
                        <h4>üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫</h4>
                        <p style="margin: 5px 0; font-size: 14px; color: #0056b3;">
                            <strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="auto-update-status">–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ</span>
                        </p>
                        <div style="margin-top: 10px;">
                            <input type="url" id="source-url" placeholder="https://example.com/playlist.m3u8" style="width: 60%; margin-right: 10px;">
                            <button class="btn btn-success" onclick="setupAutoUpdate()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å</button>
                            <button class="btn" onclick="testSourceURL()" style="background: #17a2b8; color: white; margin-left: 5px;">üß™ –¢–µ—Å—Ç URL</button>
                        </div>
                        <div style="margin-top: 10px;">
                            <button class="btn" onclick="checkSourceChanges()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                            <button class="btn btn-danger" onclick="disableAutoUpdate()">‚èπÔ∏è –û—Ç–∫–ª—é—á–∏—Ç—å</button>
                            <button class="btn" onclick="toggleChannelDebug()" id="debug-btn" style="background: #6c757d; color: white; margin-left: 5px;">üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</button>
                        </div>
                        <div style="margin-top: 10px; font-size: 12px; color: #666;">
                            ‚è∞ –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞: –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
                        </div>
                        <div id="auto-update-info" style="margin-top: 10px; padding: 8px; background: #e9ecef; border-radius: 4px; font-size: 12px; display: none;">
                            <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong><br>
                            <span id="auto-update-details"></span>
                        </div>
                    </div>
                    
                    <!-- –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ URL -->
                    <div style="background: #fff3cd; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                        <h4>üîß –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ URL</h4>
                        <div style="margin-top: 10px;">
                            <input type="url" id="manual-url" placeholder="https://example.com/playlist.m3u8" style="width: 60%; margin-right: 10px;">
                            <button class="btn btn-success" onclick="updateChannelsFromURL()" id="manual-update-btn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–Ω–∞–ª—ã</button>
                            <button class="btn" onclick="testManualURL()" style="background: #17a2b8; color: white; margin-left: 5px;">üß™ –¢–µ—Å—Ç URL</button>
                        </div>
                        <div style="margin-top: 10px; font-size: 12px; color: #856404;">
                            üí° –ë—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞–Ω–∞–ª–æ–≤
                        </div>
                        <div id="manual-progress" style="margin-top: 10px; display: none;">
                            <div style="background: #e9ecef; height: 4px; border-radius: 2px; overflow: hidden;">
                                <div id="manual-progress-bar" style="background: #007bff; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                            <div id="manual-progress-text" style="font-size: 12px; margin-top: 5px; color: #666;"></div>
                        </div>
                    </div>
                    
                    <!-- –°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
                    <div id="channels-update-status" style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 12px; color: #666;">
                        üìä –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å
                    </div>
                    
                    <!-- Realtime —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–Ω–∞–ª–æ–≤ -->
                    <div style="border-top: 1px solid #dee2e6; padding-top: 15px;">
                        <h4>‚úèÔ∏è Realtime —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–Ω–∞–ª–æ–≤</h4>
                        <div style="background: #e7f3ff; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #007bff;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="font-size: 14px; color: #0056b3;">
                                    <strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="realtime-edit-status">–ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</span>
                                </div>
                                <div>
                                    <button class="btn" onclick="loadForRealtimeEditing()" style="background: #17a2b8; color: white; font-size: 12px;">üìù –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</button>
                                    <button class="btn btn-success" onclick="saveRealtimeChanges()" id="realtime-save-btn" disabled style="font-size: 12px;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                                    <button class="btn" onclick="discardRealtimeChanges()" style="background: #6c757d; color: white; font-size: 12px;">‚Ü∂ –û—Ç–º–µ–Ω–∏—Ç—å</button>
                                </div>
                            </div>
                            <div id="realtime-edit-info" style="font-size: 12px; color: #0056b3; display: none;">
                                üí° –ò–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è" –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.
                            </div>
                        </div>
                        
                        <textarea id="realtime-channels-editor" 
                                  placeholder="–ù–∞–∂–º–∏—Ç–µ '–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è' —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å..." 
                                  style="height: 400px; font-family: 'Courier New', monospace; font-size: 12px;"
                                  disabled></textarea>
                                  
                        <div style="margin-top: 10px; font-size: 12px; color: #666;">
                            üìä –°–∏–º–≤–æ–ª–æ–≤: <span id="editor-char-count">0</span> | 
                            –°—Ç—Ä–æ–∫: <span id="editor-line-count">0</span> | 
                            –ö–∞–Ω–∞–ª–æ–≤: <span id="editor-channel-count">0</span>
                        </div>
                    </div>
                    
                    <!-- –û–±—ã—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ -->
                    <div style="border-top: 1px solid #dee2e6; padding-top: 15px; margin-top: 20px;">
                        <h4>üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±)</h4>
                        <input type="file" id="channels-file" accept=".m3u8,.m3u">
                        <button class="btn" onclick="uploadChannels()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞–Ω–∞–ª—ã</button>
                        <div style="margin-top: 5px; font-size: 12px; color: #666;">
                            –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ realtime —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
                        </div>
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ APK -->
                <div class="section">
                    <h3>üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ APK</h3>
                    <input type="text" id="new-version" placeholder="1.2" style="width: 100px;">
                    <input type="file" id="apk-file" accept=".apk">
                    <button class="btn btn-success" onclick="uploadAPK()">–ó–∞–≥—Ä—É–∑–∏—Ç—å APK</button>
                    <br><br>
                    <label>Changelog:</label>
                    <textarea id="changelog" placeholder="üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏\n‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏" style="height: 60px;"></textarea>
                    <label>
                        <input type="checkbox" id="update-required"> –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    </label>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Å—Ç–∞–≤–∫–æ–π -->
                <div class="section">
                    <h3>üé® –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Å—Ç–∞–≤–∫–æ–π</h3>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #007bff;">
                        <h4>üìä –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –∑–∞—Å—Ç–∞–≤–∫–∏</h4>
                        <p style="margin: 5px 0; font-size: 14px; color: #0056b3;">
                            <strong>–í–µ—Ä—Å–∏—è:</strong> <span id="splash-version">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </p>
                        <p style="margin: 5px 0; font-size: 14px; color: #0056b3;">
                            <strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> <span id="splash-last-updated">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4>üì± –õ–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h4>
                            <input type="file" id="splash-logo-file" accept="image/png,image/jpg,image/jpeg" style="margin: 10px 0;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                                –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 250x250px, PNG
                            </div>
                            <img id="splash-logo-preview" style="max-width: 150px; max-height: 150px; border: 1px solid #ddd; border-radius: 5px; display: none;">
                        </div>
                        <div>
                            <h4>üåÖ –§–æ–Ω –∑–∞—Å—Ç–∞–≤–∫–∏</h4>
                            <input type="file" id="splash-background-file" accept="image/png,image/jpg,image/jpeg" style="margin: 10px 0;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                                –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 1920x1080px, PNG/JPG
                            </div>
                            <img id="splash-background-preview" style="max-width: 150px; max-height: 100px; border: 1px solid #ddd; border-radius: 5px; display: none;">
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="uploadSplashImages()" id="upload-splash-btn">üé® –û–±–Ω–æ–≤–∏—Ç—å –∑–∞—Å—Ç–∞–≤–∫—É</button>
                    <button class="btn" onclick="loadSplashInfo()" style="background: #6c757d;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px; border-left: 4px solid #ffc107;">
                        <p style="margin: 0; font-size: 12px; color: #856404;">
                            <strong>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong><br>
                            1. –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –Ω–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å –∑–∞—Å—Ç–∞–≤–∫—É"<br>
                            2. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GitHub<br>
                            3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤–µ—Ä—Å–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏<br>
                            4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤—è—Ç –∑–∞—Å—Ç–∞–≤–∫—É –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç
                        </p>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <h4>üñºÔ∏è –¢–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="text-align: center;">
                                <p><strong>–õ–æ–≥–æ—Ç–∏–ø</strong></p>
                                <img id="current-splash-logo" style="max-width: 100px; max-height: 100px; border: 1px solid #ddd; border-radius: 5px;" 
                                     src="https://artemon4es.github.io/tv-channels-api/files/splash/logo_app.png" alt="–¢–µ–∫—É—â–∏–π –ª–æ–≥–æ—Ç–∏–ø">
                            </div>
                            <div style="text-align: center;">
                                <p><strong>–§–æ–Ω</strong></p>
                                <img id="current-splash-background" style="max-width: 100px; max-height: 60px; border: 1px solid #ddd; border-radius: 5px;" 
                                     src="https://artemon4es.github.io/tv-channels-api/files/splash/background.png" alt="–¢–µ–∫—É—â–∏–π —Ñ–æ–Ω">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏ –∫–∞–Ω–∞–ª–æ–≤ -->
                <div class="section">
                    <h3>üì∫ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏ –∫–∞–Ω–∞–ª–æ–≤</h3>
                    <div style="background: #f0f8ff; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #007bff;">
                        <h4>üìä –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ª–æ–≥–æ—Ç–∏–ø–æ–≤</h4>
                        <p style="margin: 5px 0; font-size: 14px; color: #0056b3;">
                            <strong>–í–µ—Ä—Å–∏—è:</strong> <span id="logos-version">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </p>
                        <p style="margin: 5px 0; font-size: 14px; color: #0056b3;">
                            <strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> <span id="logos-last-updated">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤</h4>
                        <input type="file" id="channel-logos-files" accept="image/png,image/jpg,image/jpeg" multiple style="margin: 10px 0;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                            –í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ PNG/JPG. –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä: ntv.png, sts.png)
                        </div>
                        <button class="btn btn-success" onclick="uploadChannelLogos()" id="upload-logos-btn">üì∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø—ã</button>
                        <button class="btn" onclick="loadChannelLogosInfo()" style="background: #6c757d;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìã –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤</h4>
                        <div style="background: #e7f3ff; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #007bff;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 14px; color: #0056b3;">
                                    <strong>–í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤:</strong> <span id="total-channels-count">-</span> |
                                    <strong>–ë–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–æ–≤:</strong> <span id="channels-without-logos-count">-</span> |
                                    <strong>–° –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏:</strong> <span id="channels-with-logos-count">-</span>
                                </div>
                                <button class="btn" onclick="loadAllChannelsAnalysis()" style="background: #007bff; color: white; font-size: 12px;">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                            </div>
                            <div id="channels-analysis-list" style="margin-top: 10px; display: none;">
                                <div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 4px; border: 1px solid #d1ecf1;">
                                    <div id="channels-analysis-content">–ù–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üé® –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; align-items: end;">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞:</label>
                                <select id="single-logo-channel" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª...</option>
                                </select>
                                <div style="font-size: 10px; color: #666; margin-top: 2px;">–ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –∑–∞–º–µ–Ω—ã/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–æ—Ç–∏–ø–æ–≤</div>
                            </div>
                            <div>
                                <label>–§–∞–π–ª –ª–æ–≥–æ—Ç–∏–ø–∞:</label>
                                <input type="file" id="single-logo-file" accept="image/png,image/jpg,image/jpeg" style="width: 100%;">
                            </div>
                            <div>
                                <button class="btn" onclick="uploadSingleChannelLogo()" style="background: #17a2b8; color: white;">üéØ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px; border-left: 4px solid #ffc107;">
                        <p style="margin: 0; font-size: 12px; color: #856404;">
                            <strong>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong><br>
                            1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ª–æ–≥–æ—Ç–∏–ø—ã –∫–∞–Ω–∞–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ PNG/JPG<br>
                            2. –§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π<br>
                            3. –í–µ—Ä—Å–∏—è –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏<br>
                            4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç –Ω–æ–≤—ã–µ –ª–æ–≥–æ—Ç–∏–ø—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç
                        </p>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <h4>üñºÔ∏è –¢–µ–∫—É—â–∏–µ –ª–æ–≥–æ—Ç–∏–ø—ã –∫–∞–Ω–∞–ª–æ–≤</h4>
                        <div id="current-channel-logos" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                            <div style="text-align: center; color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                        <button class="btn" onclick="loadCurrentChannelLogos()" style="background: #6c757d; margin-top: 10px;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                    </div>
                </div>

                <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
                <div class="section">
                    <h3>üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                    <textarea id="security-domains" placeholder="example.com&#10;cdn.example.com" style="height: 80px;"></textarea>
                    <button class="btn" onclick="updateSecurity()">–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–º–µ–Ω—ã</button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ -->
                <div class="section">
                    <h3>üñ•Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏</h3>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ Android TV</p>
                    
                    <div class="subsection">
                        <h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</h4>
                        <div id="device-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                            <div class="stat-card">
                                <div class="stat-number" id="total-devices">0</div>
                                <div class="stat-label">–í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="online-devices">0</div>
                                <div class="stat-label">–û–Ω–ª–∞–π–Ω</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="enabled-devices">0</div>
                                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="disabled-devices">0</div>
                                <div class="stat-label">–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</div>
                            </div>
                        </div>
                        <button class="btn" onclick="loadDeviceList()" style="background: #6c757d;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                    </div>

                    <div class="subsection">
                        <h4>üìã –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</h4>
                        <div id="device-list" style="margin-top: 15px;">
                            <div style="text-align: center; color: #666;">–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞" –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞</div>
                        </div>
                        <button class="btn" onclick="loadDeviceList()">üì± –ó–∞–≥—Ä—É–∑–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>
                    </div>

                    <div class="subsection">
                        <h4>‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                        <div style="margin: 15px 0;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="default-service-enabled" checked>
                                <span>–°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span>
                            </label>
                        </div>
                        <div style="margin: 15px 0;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="monitoring-enabled" checked>
                                <span>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–∫–ª—é—á–µ–Ω</span>
                            </label>
                        </div>
                        <button class="btn" onclick="updateDeviceGlobalSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π -->
    <div class="container">
        <h2>üìã –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
        <div id="operation-log" class="log">
            [–°–ò–°–¢–ï–ú–ê] Control Panel –∑–∞–≥—Ä—É–∂–µ–Ω
        </div>
        <button onclick="document.getElementById('operation-log').innerHTML = '[–°–ò–°–¢–ï–ú–ê] –õ–æ–≥ –æ—á–∏—â–µ–Ω'; log('üßπ –õ–æ–≥ –æ—á–∏—â–µ–Ω');" 
                style="margin-top: 10px; background: #6c757d; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
            üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥
        </button>
    </div>

    <script src="upload-apk-fix.js"></script>
    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            document.querySelector(`button[onclick="showTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
        let previousServiceStatus = null;
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        async function loadCurrentConfig() {
            try {
                log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
                let config = null;
                
                // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è —á–µ—Ä–µ–∑ GitHub API (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω)
                if (authToken) {
                    try {
                        log('üîç –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ GitHub API...');
                        const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/api/config.json?ref=main&t=${Date.now()}`, {
                            headers: {
                                'Authorization': `Bearer ${authToken}`,
                                'X-GitHub-Api-Version': '2022-11-28',
                                'Accept': 'application/vnd.github.v3+json',
                                'Cache-Control': 'no-cache'
                            }
                        });
                        
                        if (response.ok) {
                            const fileData = await response.json();
                            const configContent = atob(fileData.content);
                            config = JSON.parse(configContent);
                            log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ GitHub API');
                        } else {
                            log(`‚ö†Ô∏è GitHub API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (${response.status}), –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥`);
                        }
                    } catch (apiError) {
                        log(`‚ö†Ô∏è GitHub API –æ—à–∏–±–∫–∞: ${apiError.message}, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥`);
                    }
                } else {
                    log('‚ö†Ô∏è –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
                
                // –ï—Å–ª–∏ GitHub API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É —á–µ—Ä–µ–∑ GitHub Pages
                if (!config) {
                    try {
                        log('üîç –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ GitHub Pages...');
                        const response = await fetch(`https://artemon4es.github.io/tv-channels-api/api/config.json?t=${Date.now()}`, {
                            headers: {
                                'Cache-Control': 'no-cache, no-store, must-revalidate',
                                'Pragma': 'no-cache',
                                'Expires': '0'
                            }
                        });
                        
                        if (response.ok) {
                            config = await response.json();
                            log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ GitHub Pages');
                        } else {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    } catch (pagesError) {
                        throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: ${pagesError.message}`);
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
                const currentStatus = config.service_config.service_available;
                if (previousServiceStatus !== null && previousServiceStatus !== currentStatus) {
                    // –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    const statusText = currentStatus ? '–≤–∫–ª—é—á–µ–Ω' : '–æ—Ç–∫–ª—é—á–µ–Ω';
                    log(`üîÑ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ –∏–∑–º–µ–Ω–µ–Ω: ${statusText}`);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    document.title = `${currentStatus ? 'üü¢' : 'üî¥'} IPTV Control Panel - –°–µ—Ä–≤–∏—Å ${statusText}`;
                    setTimeout(() => {
                        document.title = 'üîß IPTV Control Panel';
                    }, 5000);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    setTimeout(() => {
                        const statusDiv = document.getElementById('service-status');
                        const adminStatusDiv = document.getElementById('admin-service-status');
                        
                        if (statusDiv) {
                            const bigStatus = statusDiv.querySelector('.service-status-big');
                            if (bigStatus) {
                                bigStatus.classList.add('changed');
                                setTimeout(() => bigStatus.classList.remove('changed'), 1000);
                            }
                        }
                        
                        if (adminStatusDiv) {
                            adminStatusDiv.classList.add('changed');
                            setTimeout(() => adminStatusDiv.classList.remove('changed'), 1000);
                        }
                    }, 100);
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
                previousServiceStatus = currentStatus;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                updateServiceStatus(config);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞–Ω–∞–ª–æ–≤
                try {
                    log('üîç –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...');
                    const channelsResponse = await fetch('https://artemon4es.github.io/tv-channels-api/files/channels.m3u8?' + Date.now());
                    if (channelsResponse.ok) {
                        const channelsContent = await channelsResponse.text();
                        if (document.getElementById('channels-content')) {
                            document.getElementById('channels-content').value = channelsContent;
                        }
                        log('‚úÖ –°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω');
                    } else {
                        log(`‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞–Ω–∞–ª—ã: HTTP ${channelsResponse.status}`);
                    }
                } catch (channelsError) {
                    log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–Ω–∞–ª–æ–≤: ${channelsError.message}`);
                }
                
                // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—ã —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (—É–±—Ä–∞–Ω–æ –ø–æ–ª–µ service-message)
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                const systemStatusElement = document.getElementById('system-status');
                if (systemStatusElement && config) {
                    systemStatusElement.innerHTML = `
                        <p><strong>–°–µ—Ä–≤–∏—Å:</strong> ${config.service_config.service_available ? '‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}</p>
                        <p><strong>–í–µ—Ä—Å–∏—è –∫–∞–Ω–∞–ª–æ–≤:</strong> ${config.channels_config.version}</p>
                        <p><strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> ${new Date(config.channels_config.last_updated).toLocaleString()}</p>
                        <p><strong>–í–µ—Ä—Å–∏—è APK:</strong> ${config.app_info.current_version} ‚Üí ${config.app_info.latest_version}</p>
                    `;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞—Å—Ç–∞–≤–∫–µ –∏ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö
                updateSplashInfo(config);
                updateChannelLogosInfo(config);
                
                if (config) {
                    log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞');
                } else {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∏ –æ–¥–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º');
                }
                
            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ' + error.message);
                log('üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –æ—à–∏–±–∫–∏
                const statusDiv = document.getElementById('service-status');
                if (statusDiv) {
                    statusDiv.innerHTML = `
                        <div class="service-status-big offline">
                            ‚ùå –û–®–ò–ë–ö–ê –ó–ê–ì–†–£–ó–ö–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
                            <div style="font-size: 14px; margin-top: 10px; font-weight: normal;">
                                ${error.message}
                            </div>
                        </div>
                    `;
                }
            }
        }

        function updateServiceStatus(config) {
            const statusDiv = document.getElementById('service-status');
            const adminStatusDiv = document.getElementById('admin-service-status');
            const isOnline = config.service_config.service_available;
            
            // –ë–æ–ª—å—à–æ–π —Å—Ç–∞—Ç—É—Å –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏
            statusDiv.innerHTML = `
                <div class="service-status-big ${isOnline ? 'online' : 'offline'}">
                    ${isOnline ? 'üü¢ –°–ï–†–í–ò–° –ê–ö–¢–ò–í–ï–ù' : 'üî¥ –°–ï–†–í–ò–° –û–¢–ö–õ–Æ–ß–ï–ù'}
                    <div style="font-size: 14px; margin-top: 10px; font-weight: normal;">
                        ${isOnline ? '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —ç–∫—Ä–∞–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏'}
                    </div>
                </div>
                <div style="display: flex; gap: 20px; justify-content: center; margin-top: 10px;">
                    <span class="status-indicator ${isOnline ? 'online' : 'offline'}">
                        ${isOnline ? 'üü¢ –°–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–µ–Ω' : 'üî¥ –°–µ—Ä–≤–∏—Å –æ—Ç–∫–ª—é—á–µ–Ω'}
                    </span>
                    <span style="background: #e9ecef; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                        üì∫ –ö–∞–Ω–∞–ª—ã: v${config.channels_config.version}
                    </span>
                    <span style="background: #e9ecef; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                        üì± APK: v${config.app_info.current_version} ‚Üí v${config.app_info.latest_version}
                    </span>
                </div>
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ —Ä–∞–∑–¥–µ–ª–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
            if (adminStatusDiv) {
                adminStatusDiv.className = `service-status-big ${isOnline ? 'online' : 'offline'}`;
                adminStatusDiv.innerHTML = `
                    ${isOnline ? 'üü¢ –°–ï–†–í–ò–° –ê–ö–¢–ò–í–ï–ù' : 'üî¥ –°–ï–†–í–ò–° –û–¢–ö–õ–Æ–ß–ï–ù'}
                    <div style="font-size: 14px; margin-top: 10px; font-weight: normal;">
                        ${isOnline ? '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —ç–∫—Ä–∞–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏'}
                    </div>
                `;
            }
        }

        async function enableService() {
            log('üîÑ –í–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞...');
            log('üîç DEBUG: –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è enableService()');
            
            try {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –Ω–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
                verifyConfigChange.attempts = 0;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è GitHub API
                if (!authToken) {
                    log('‚ö†Ô∏è –¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.');
                    log('üí° –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ GitHub
                log('üîç DEBUG: –í—ã–∑—ã–≤–∞–µ–º updateConfigFieldDirect —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º TRUE');
                await updateConfigFieldDirect('service_config.service_available', true);
                await updateConfigFieldDirect('service_config.message', '');
                log('‚úÖ –°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–µ–Ω!');
                
                // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
                showServiceStatusChange(true, '');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ (–±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è GitHub Pages)
                setTimeout(async () => {
                    await verifyConfigChange(true);
                }, 5000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞: ${error.message}`);
                
                // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–æ–∫–µ–Ω–æ–º, –¥–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                if (error.message.includes('token') || error.message.includes('401') || error.message.includes('403')) {
                    log('üîë –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω GitHub –≤ —Ä–∞–∑–¥–µ–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
                    log('üí° –í–æ–∑–º–æ–∂–Ω–æ, —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞');
                } else {
                    log('üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥');
                }
                
                // –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
                setTimeout(loadCurrentConfig, 2000);
            }
        }

        async function disableService() {
            log('üîÑ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞...');
            log('üîç DEBUG: –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è disableService()');
            
            try {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –Ω–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
                verifyConfigChange.attempts = 0;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è GitHub API
                if (!authToken) {
                    log('‚ö†Ô∏è –¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.');
                    log('üí° –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ GitHub
                log('üîç DEBUG: –í—ã–∑—ã–≤–∞–µ–º updateConfigFieldDirect —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º FALSE');
                await updateConfigFieldDirect('service_config.service_available', false);
                await updateConfigFieldDirect('service_config.message', '');
                log('‚ùå –°–µ—Ä–≤–∏—Å –æ—Ç–∫–ª—é—á–µ–Ω!');
                
                // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
                showServiceStatusChange(false, '');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ (–±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è GitHub Pages)
                setTimeout(async () => {
                    await verifyConfigChange(false);
                }, 5000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞: ${error.message}`);
                
                // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–æ–∫–µ–Ω–æ–º, –¥–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                if (error.message.includes('token') || error.message.includes('401') || error.message.includes('403')) {
                    log('üîë –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω GitHub –≤ —Ä–∞–∑–¥–µ–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
                    log('üí° –í–æ–∑–º–æ–∂–Ω–æ, —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞');
                } else {
                    log('üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥');
                }
                
                // –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
                setTimeout(loadCurrentConfig, 2000);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
        function showServiceStatusChange(isOnline, message) {
            const statusDiv = document.getElementById('service-status');
            const adminStatusDiv = document.getElementById('admin-service-status');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.title = `${isOnline ? 'üü¢' : 'üî¥'} IPTV Control Panel - ${isOnline ? '–í–∫–ª—é—á–∞–µ–º' : '–û—Ç–∫–ª—é—á–∞–µ–º'} —Å–µ—Ä–≤–∏—Å...`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞–ø—Ä—è–º—É—é –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö
            if (statusDiv) {
                statusDiv.innerHTML = `
                    <div class="service-status-big ${isOnline ? 'online' : 'offline'} changed">
                        ${isOnline ? 'üü¢ –°–ï–†–í–ò–° –í–ö–õ–Æ–ß–ê–ï–¢–°–Ø...' : 'üî¥ –°–ï–†–í–ò–° –û–¢–ö–õ–Æ–ß–ê–ï–¢–°–Ø...'}
                        <div style="font-size: 14px; margin-top: 10px; font-weight: normal;">
                            ${isOnline ? '–û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é...' : '–ë–ª–æ–∫–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...'}
                        </div>
                    </div>
                    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 10px;">
                        <span class="status-indicator ${isOnline ? 'online' : 'offline'}">
                            ${isOnline ? 'üü¢ –í–∫–ª—é—á–µ–Ω–∏–µ...' : 'üî¥ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ...'}
                        </span>
                        <span style="background: #ffc107; color: #212529; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                            ‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...
                        </span>
                    </div>
                `;
            }
            
            if (adminStatusDiv) {
                adminStatusDiv.className = `service-status-big ${isOnline ? 'online' : 'offline'} changed`;
                adminStatusDiv.innerHTML = `
                    ${isOnline ? 'üü¢ –°–ï–†–í–ò–° –í–ö–õ–Æ–ß–ê–ï–¢–°–Ø...' : 'üî¥ –°–ï–†–í–ò–° –û–¢–ö–õ–Æ–ß–ê–ï–¢–°–Ø...'}
                    <div style="font-size: 14px; margin-top: 10px; font-weight: normal;">
                        ${isOnline ? '–û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é...' : '–ë–ª–æ–∫–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...'}
                    </div>
                `;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        async function verifyConfigChange(expectedStatus) {
            try {
                log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
                
                let config = null;
                
                // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è —á–µ—Ä–µ–∑ GitHub API (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω)
                if (authToken) {
                    try {
                        const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/api/config.json?ref=main&t=${Date.now()}`, {
                            headers: {
                                'Authorization': `Bearer ${authToken}`,
                                'X-GitHub-Api-Version': '2022-11-28',
                                'Accept': 'application/vnd.github.v3+json',
                                'Cache-Control': 'no-cache, no-store, must-revalidate',
                                'Pragma': 'no-cache',
                                'Expires': '0'
                            }
                        });
                        
                        if (response.ok) {
                            const fileData = await response.json();
                            const decodedContent = atob(fileData.content);
                            config = JSON.parse(decodedContent);
                            log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ GitHub API');
                        } else {
                            log(`‚ö†Ô∏è GitHub API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (${response.status}), –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥`);
                        }
                    } catch (apiError) {
                        log(`‚ö†Ô∏è GitHub API –æ—à–∏–±–∫–∞: ${apiError.message}, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥`);
                    }
                }
                
                // –ï—Å–ª–∏ GitHub API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É
                if (!config) {
                    try {
                        const response = await fetch(`./api/config.json?t=${Date.now()}`, {
                            headers: {
                                'Cache-Control': 'no-cache, no-store, must-revalidate',
                                'Pragma': 'no-cache',
                                'Expires': '0'
                            }
                        });
                        
                        if (response.ok) {
                            config = await response.json();
                            log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ GitHub Pages');
                        } else {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    } catch (pagesError) {
                        throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: ${pagesError.message}`);
                    }
                }
                
                const actualStatus = config.service_config.service_available;
                
                if (actualStatus === expectedStatus) {
                    log('‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!');
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ
                    verifyConfigChange.attempts = 0;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                    updateServiceStatus(config);
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
                    document.title = 'üîß IPTV Control Panel';
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —É—Å–ø–µ—Ö–∞
                    const statusDiv = document.getElementById('service-status');
                    const adminStatusDiv = document.getElementById('admin-service-status');
                    
                    if (statusDiv) {
                        const bigStatus = statusDiv.querySelector('.service-status-big');
                        if (bigStatus) {
                            bigStatus.classList.add('changed');
                            setTimeout(() => bigStatus.classList.remove('changed'), 1000);
                        }
                    }
                    
                    if (adminStatusDiv) {
                        adminStatusDiv.classList.add('changed');
                        setTimeout(() => adminStatusDiv.classList.remove('changed'), 1000);
                    }
                    
                } else {
                    log(`‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏—è –µ—â–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å. –û–∂–∏–¥–∞–µ–º: ${expectedStatus}, –ø–æ–ª—É—á–∏–ª–∏: ${actualStatus}`);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
                    if (!verifyConfigChange.attempts) {
                        verifyConfigChange.attempts = 0;
                    }
                    verifyConfigChange.attempts++;
                    
                                         if (verifyConfigChange.attempts < 10) {
                         // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–æ–π
                         const delay = Math.min(5000 + (verifyConfigChange.attempts * 2000), 15000);
                         log(`üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ ${delay/1000} —Å–µ–∫—É–Ω–¥... (–ø–æ–ø—ã—Ç–∫–∞ ${verifyConfigChange.attempts}/10)`);
                         
                         // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ—Å–ª–µ 3-—Ö –ø–æ–ø—ã—Ç–æ–∫
                         if (verifyConfigChange.attempts >= 3) {
                             log('üí° –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - GitHub Pages –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π. –ü–æ–¥–æ–∂–¥–∏—Ç–µ...');
                         }
                         
                         setTimeout(async () => {
                             await verifyConfigChange(expectedStatus);
                         }, delay);
                     } else {
                        log('‚ö†Ô∏è –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ (10)');
                        log('üí° GitHub Pages –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–æ 10 –º–∏–Ω—É—Ç. –ò–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.');
                        log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ...');
                        
                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –æ–∂–∏–¥–∞–µ–º—ã–º —Å—Ç–∞—Ç—É—Å–æ–º
                        const mockConfig = {
                            service_config: {
                                service_available: expectedStatus,
                                message: ''
                            },
                            channels_config: { version: 'loading...' },
                            app_info: { 
                                current_version: 'loading...',
                                latest_version: 'loading...'
                            }
                        };
                        updateServiceStatus(mockConfig);
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
                        verifyConfigChange.attempts = 0;
                        
                        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
                        document.title = 'üîß IPTV Control Panel';
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
                        setTimeout(loadCurrentConfig, 30000);
                    }
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${error.message}`);
                log('üîÑ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ–±—ã—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                verifyConfigChange.attempts = 0;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ–±—ã—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º
                setTimeout(loadCurrentConfig, 2000);
            }
        }

        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        async function saveChannels(contentOverride) {
            // –ë–µ—Ä–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –ª–∏–±–æ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –ª–∏–±–æ –∏–∑ textarea (–µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å)
            let content = contentOverride;
            if (!content) {
                const el = document.getElementById('channels-content');
                if (!el) {
                    throw new Error('–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–Ω–∞–ª–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                }
                content = el.value;
            }
            
            if (!content.includes('#EXTM3U')) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç! –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å #EXTM3U');
                return;
            }
            
            log('üîÑ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ GitHub Actions...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-channels.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            channels_content: content
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                    throw new Error(`GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`);
                }
                
                log('‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤');
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 30-60 —Å–µ–∫—É–Ω–¥)');
                
                // –ñ–¥–µ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                await waitForChannelsUpdate();
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤: ${error.message}`);
            }
        }

        function uploadChannels() {
            const channelsFile = document.getElementById('channels-file').files[0];
            
            if (!channelsFile) {
                alert('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–Ω–∞–ª–æ–≤');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                if (!content.includes('#EXTM3U')) {
                    alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç! –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å #EXTM3U');
                    return;
                }
                
                document.getElementById('channels-content').value = content;
                log(`üì∫ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: ${channelsFile.name}`);
                saveChannels();
            };
            reader.readAsText(channelsFile);
        }

        async function uploadAPK() {
            const newVersion = document.getElementById('new-version').value;
            const changelog = document.getElementById('changelog').value;
            const updateRequired = document.getElementById('update-required').checked;
            const apkFile = document.getElementById('apk-file').files[0];
            
            if (!newVersion) {
                alert('‚ùå –£–∫–∞–∂–∏—Ç–µ –≤–µ—Ä—Å–∏—é APK');
                return;
            }
            
            if (!apkFile) {
                alert('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ APK —Ñ–∞–π–ª');
                return;
            }
            
            log(`üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ APK v${newVersion} —á–µ—Ä–µ–∑ GitHub API (${(apkFile.size / 1024 / 1024).toFixed(1)} MB)...`);
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º APK –Ω–∞–ø—Ä—è–º—É—é –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
                log('üì§ –ó–∞–≥—Ä—É–∑–∫–∞ APK —Ñ–∞–π–ª–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π...');
                
                // –°–æ–∑–¥–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞
                const apkFileName = `app-v${newVersion}.apk`;
                const apkPath = `files/updates/${apkFileName}`;
                
                // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ binary –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ base64 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FileReader
                // –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ—à–∏–±–∫–∏ Maximum call stack size exceeded
                const base64Content = await new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => {
                        // –ü–æ–ª—É—á–∞–µ–º base64 —Å—Ç—Ä–æ–∫—É, —É–¥–∞–ª—è—è –ø—Ä–µ—Ñ–∏–∫—Å data:application/...
                        const base64 = reader.result.split(',')[1];
                        resolve(base64);
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(apkFile);
                });
                
                // –ü–æ–ª—É—á–∞–µ–º SHA –µ—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –µ—Å—Ç—å
                let apkSha = null;
                try {
                    const getResponse = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/${apkPath}`, {
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'X-GitHub-Api-Version': '2022-11-28',
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    if (getResponse.ok) {
                        const fileData = await getResponse.json();
                        apkSha = fileData.sha;
                    }
                } catch (e) {
                    // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî sha –Ω–µ –Ω—É–∂–µ–Ω
                }

                // –ó–∞–≥—Ä—É–∂–∞–µ–º APK —Ñ–∞–π–ª
                log('üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ APK —Ñ–∞–π–ª–∞...');
                const uploadData = {
                    message: `üì± Add APK v${newVersion}`,
                    content: base64Content,
                    branch: 'main'
                };
                if (apkSha) uploadData.sha = apkSha;
                const uploadResponse = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/${apkPath}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(uploadData)
                });
                
                if (!uploadResponse.ok) {
                    const errorData = await uploadResponse.json();
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ APK: ${errorData.message}`);
                }
                
                log('‚úÖ APK —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º config.json
                log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                const configResponse = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/api/config.json`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!configResponse.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ${configResponse.status}`);
                }
                
                const configData = await configResponse.json();
                const config = JSON.parse(atob(configData.content));
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º version_code –∏–∑ –≤–µ—Ä—Å–∏–∏
                const versionCode = parseInt(newVersion.replace(/\./g, '')) || 1;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                config.app_info.latest_version = newVersion;
                config.app_info.version_code = versionCode;
                config.app_info.download_url = `https://artemon4es.github.io/tv-channels-api/files/updates/${apkFileName}`;
                config.app_info.update_required = updateRequired;
                config.app_info.changelog = changelog;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                const updateConfigResponse = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/api/config.json`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `üì± Update config for APK v${newVersion}`,
                        content: btoa(unescape(encodeURIComponent(JSON.stringify(config, null, 2)))),
                        sha: configData.sha,
                        branch: 'main'
                    })
                });
                
                if (!updateConfigResponse.ok) {
                    const errorData = await updateConfigResponse.json().catch(() => ({ message: 'Unknown error' }));
                    throw new Error(`–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ${errorData.message}`);
                }
                
                log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-2 –º–∏–Ω—É—Ç—ã)');
                
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('new-version').value = '';
                document.getElementById('changelog').value = '';
                document.getElementById('update-required').checked = false;
                document.getElementById('apk-file').value = '';
                
                // –ñ–¥–µ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                await waitForAPKUpdate(newVersion);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ APK: ${error.message}`);
            }
        }

        async function updateSecurity() {
            const domains = document.getElementById('security-domains').value;
            
            if (!domains.trim()) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è');
                return;
            }
            
            log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ GitHub Actions...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-security.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            domains: domains
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                    throw new Error(`GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`);
                }
                
                const domainCount = domains.split('\n').filter(d => d.trim()).length;
                log(`‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ${domainCount} –¥–æ–º–µ–Ω–æ–≤`);
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 30-60 —Å–µ–∫—É–Ω–¥)');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ
                document.getElementById('security-domains').value = '';
                
                // –ñ–¥–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                setTimeout(() => {
                    log('‚úÖ –î–æ–º–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
                }, 30000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–≤: ${error.message}`);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –æ–∂–∏–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        async function waitForChannelsUpdate() {
            const maxAttempts = 12;
            let attempts = 0;
            
            while (attempts < maxAttempts) {
                attempts++;
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 10000));
                    log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤... (–ø–æ–ø—ã—Ç–∫–∞ ${attempts}/${maxAttempts})`);
                    
                    const response = await fetch(`https://artemon4es.github.io/tv-channels-api/files/channels.m3u8?t=${Date.now()}`, {
                        headers: { 'Cache-Control': 'no-cache' }
                    });
                    
                    if (response.ok) {
                        const newChannels = await response.text();
                        const currentChannels = document.getElementById('channels-content').value;
                        
                        if (newChannels !== currentChannels) {
                            log('‚úÖ –ö–∞–Ω–∞–ª—ã —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
                            document.getElementById('channels-content').value = newChannels;
                            setTimeout(loadCurrentConfig, 2000);
                            return;
                        }
                    }
                    
                } catch (error) {
                    log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`);
                }
            }
            
            log('‚ö†Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Actions –≤—Ä—É—á–Ω—É—é.');
        }

        async function waitForAPKUpdate(expectedVersion) {
            const maxAttempts = 12;
            let attempts = 0;
            
            while (attempts < maxAttempts) {
                attempts++;
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 15000));
                    log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è APK... (–ø–æ–ø—ã—Ç–∫–∞ ${attempts}/${maxAttempts})`);
                    
                    const response = await fetch(`https://artemon4es.github.io/tv-channels-api/api/config.json?t=${Date.now()}`, {
                        headers: { 'Cache-Control': 'no-cache' }
                    });
                    
                    if (response.ok) {
                        const config = await response.json();
                        if (config.app_info && config.app_info.latest_version === expectedVersion) {
                            log(`‚úÖ APK v${expectedVersion} —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!`);
                            setTimeout(loadCurrentConfig, 2000);
                            return;
                        }
                    }
                    
                } catch (error) {
                    log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`);
                }
            }
            
            log('‚ö†Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Actions –≤—Ä—É—á–Ω—É—é.');
        }

        // ===== –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –ß–ï–†–ï–ó GITHUB ACTIONS =====
        
        async function updateConfigFieldDirect(field, value) {
            log(`üîç DEBUG: updateConfigFieldDirect –≤—ã–∑–≤–∞–Ω–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: field="${field}", value=${value} (—Ç–∏–ø: ${typeof value})`);
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-config.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            field: field,
                            value: value.toString()
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                    let errorMessage = `GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`;
                    
                    if (response.status === 401) {
                        errorMessage += '\nüîë –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω GitHub - –≤–æ–∑–º–æ–∂–Ω–æ, –æ–Ω –∏—Å—Ç–µ–∫';
                    } else if (response.status === 403) {
                        errorMessage += '\nüîê –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ - —Ç–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ actions';
                    } else if (response.status === 404) {
                        errorMessage += '\nüìÅ Workflow –Ω–µ –Ω–∞–π–¥–µ–Ω - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª .github/workflows/update-config.yml';
                    }
                    
                    throw new Error(errorMessage);
                }
                
                log(`‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ${field} = ${value}`);
                log(`‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 30-60 —Å–µ–∫—É–Ω–¥)`);
                
                // –ñ–¥–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Action (–ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥)
                await waitForActionCompletion(field, value);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ${field}: ${error.message}`);
                throw error;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è GitHub Action
        async function waitForActionCompletion(field, expectedValue) {
            const maxAttempts = 12; // 2 –º–∏–Ω—É—Ç—ã –º–∞–∫—Å–∏–º—É–º
            let attempts = 0;
            
            while (attempts < maxAttempts) {
                attempts++;
                
                try {
                    // –ñ–¥–µ–º 10 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π
                    await new Promise(resolve => setTimeout(resolve, 10000));
                    
                    log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞... (–ø–æ–ø—ã—Ç–∫–∞ ${attempts}/${maxAttempts})`);
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    const response = await fetch(`https://artemon4es.github.io/tv-channels-api/api/config.json?t=${Date.now()}`, {
                        headers: {
                            'Cache-Control': 'no-cache, no-store, must-revalidate',
                            'Pragma': 'no-cache',
                            'Expires': '0'
                        }
                    });
                    
                    if (response.ok) {
                        const config = await response.json();
                        const keys = field.split('.');
                        let value = config;
                        
                        for (const key of keys) {
                            if (value && typeof value === 'object' && key in value) {
                                value = value[key];
                            } else {
                                value = undefined;
                                break;
                            }
                        }
                        
                        if (value === expectedValue) {
                            log(`‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã! ${field} = ${value}`);
                            updateServiceStatus(config);
                            return;
                        } else {
                            log(`‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ... —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: ${value}, –æ–∂–∏–¥–∞–µ–º: ${expectedValue}`);
                        }
                    } else {
                        log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: HTTP ${response.status}`);
                    }
                    
                } catch (error) {
                    log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`);
                }
            }
            
            log(`‚ö†Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. GitHub Action –º–æ–∂–µ—Ç –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.`);
            log(`üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.`);
        }

        function log(message) {
            const logDiv = document.getElementById('operation-log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `\n[${timestamp}] ${message}`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    log('‚úÖ –ö–æ–º–∞–Ω–¥–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                }).catch(() => {
                    log('‚ö†Ô∏è –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤—Ä—É—á–Ω—É—é');
                });
            } else {
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    log('‚úÖ –ö–æ–º–∞–Ω–¥–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                } catch (err) {
                    log('‚ö†Ô∏è –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤—Ä—É—á–Ω—É—é');
                }
                document.body.removeChild(textArea);
            }
        }

        // ===== –°–ò–°–¢–ï–ú–ê –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò =====
        let authToken = localStorage.getItem('github-token');

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            if (authToken) {
                verifyToken(authToken);
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            initializeAutoUpdateStatus();
        };

        async function authenticate() {
            const token = document.getElementById('auth-token').value.trim();
            const errorDiv = document.getElementById('auth-error');
            
            if (!token) {
                showAuthError('–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω');
                return;
            }
            
            errorDiv.style.display = 'none';
            document.querySelector('#auth-container .btn').textContent = 'üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞...';
            
            const isValid = await verifyToken(token);
            
            if (isValid) {
                authToken = token;
                localStorage.setItem('github-token', token);
                document.getElementById('auth-container').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                loadCurrentConfig();
                setInterval(loadCurrentConfig, 120000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                initializeAutoUpdateStatus();
            } else {
                document.querySelector('#auth-container .btn').textContent = 'üîì –í–æ–π—Ç–∏';
                showAuthError('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é');
            }
        }

        async function verifyToken(token) {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—à–µ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é
                const response = await fetch('https://api.github.com/repos/artemon4es/tv-channels-api', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const repo = await response.json();
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —É —Ç–æ–∫–µ–Ω–∞ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –∏ actions
                    const hasWriteAccess = repo.permissions && repo.permissions.push;
                    
                    if (hasWriteAccess) {
                        log('‚úÖ –¢–æ–∫–µ–Ω –ø—Ä–æ–≤–µ—Ä–µ–Ω: –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π');
                        log('üí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞: repo, workflow, actions');
                        return true;
                    } else {
                        log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π');
                        return false;
                    }
                }
                
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:', error);
                return false;
            }
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('auth-error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function logout() {
            localStorage.removeItem('github-token');
            authToken = null;
            document.getElementById('auth-container').classList.remove('hidden');
            document.getElementById('main-content').classList.add('hidden');
            document.getElementById('auth-token').value = '';
        }

        // Enter key –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !document.getElementById('auth-container').classList.contains('hidden')) {
                authenticate();
            }
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã)
        // loadCurrentConfig(); - —É–±—Ä–∞–Ω–æ, –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã)
        // setInterval(loadCurrentConfig, 30000); - —É–±—Ä–∞–Ω–æ, –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

        // ===== –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ì–û –ò –†–£–ß–ù–û–ì–û –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ö–ê–ù–ê–õ–û–í =====

        // –°–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π - —Ç–æ–ª—å–∫–æ EXTINF —Å—Ç—Ä–æ–∫–∏)
        const TARGET_CHANNELS = [
            {
                name: '–ü–µ—Ä–≤—ã–π –∫–∞–Ω–∞–ª HD',
                extinf: '#EXTINF:-1 tvg-id="pervy" tvg-logo="http://i122.fastpic.org/big/2023/0704/13/cd5a5508b20da12d6131cafd8eb23513.png" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–ü–µ—Ä–≤—ã–π –∫–∞–Ω–∞–ª HD'
            },
            {
                name: '–†–æ—Å—Å–∏—è 1 HD',
                extinf: '#EXTINF:-1 tvg-id="rossia1" tvg-logo="http://i122.fastpic.org/big/2023/0705/de/ab393bef44b80dc1d57351855763b4de.png" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–†–æ—Å—Å–∏—è 1 HD'
            },
            {
                name: '–†–æ—Å—Å–∏—è-24',
                extinf: '#EXTINF:-1 tvg-logo="https://iptvx.one/picons/rossia-24.png" tvg-id="rossia-24" group-title="–ù–æ–≤–æ—Å—Ç–∏", –†–æ—Å—Å–∏—è-24'
            },
            {
                name: '–†–æ—Å—Å–∏—è –ö—É–ª—å—Ç—É—Ä–∞',
                extinf: '#EXTINF:-1 tvg-id="kultura" tvg-logo="https://getsiptv.ru/img/ch_icons/rossiya_kultura.png" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ", –†–æ—Å—Å–∏—è –ö—É–ª—å—Ç—É—Ä–∞'
            },
            {
                name: '–ù–¢–í HD',
                extinf: '#EXTINF:-1 tvg-id="ntv" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–ù–¢–í HD'
            },
            {
                name: '–¢–ù–¢ HD',
                extinf: '#EXTINF:-1 group-title="–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ",–¢–ù–¢ HD'
            },
            {
                name: '–°–¢–° HD',
                extinf: '#EXTINF:-1 group-title="–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ",–°–¢–° HD'
            },
            {
                name: '–¢–í-3 HD',
                extinf: '#EXTINF:-1 tvg-id="tv3-ru" tvg-logo="http://only4.tv/ch/1008.png" group-title="–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ",–¢–í-3 HD'
            },
            {
                name: '–ó–≤–µ–∑–¥–∞ HD',
                extinf: '#EXTINF:-1 tvg-id="zvezda" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–ó–≤–µ–∑–¥–∞ HD'
            },
            {
                name: '–†–µ–Ω –¢–í HD',
                extinf: '#EXTINF:-1 tvg-id="rentv" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–†–µ–Ω –¢–í HD'
            },
            {
                name: '–¢–í –¶–µ–Ω—Ç—Ä HD',
                extinf: '#EXTINF:-1 tvg-id="tvcentr" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–¢–í –¶–µ–Ω—Ç—Ä HD'
            },
            {
                name: '5 –∫–∞–Ω–∞–ª –†–æ—Å—Å–∏—è',
                extinf: '#EXTINF:-1 tvg-id="5kanal-ru" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ", 5 –∫–∞–Ω–∞–ª –†–æ—Å—Å–∏—è'
            },
            {
                name: '–î–æ–º–∞—à–Ω–∏–π HD',
                extinf: '#EXTINF:-1 tvg-id="domashny" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–î–æ–º–∞—à–Ω–∏–π HD'
            },
            {
                name: '–ü—è—Ç–Ω–∏—Ü–∞ HD',
                extinf: '#EXTINF:-1 tvg-logo="https://i116.fastpic.org/big/2021/1107/d9/129dc2e5164bfcd303ad98fbde6e78d9.png" group-title="–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ",–ü—è—Ç–Ω–∏—Ü–∞ HD'
            },
            {
                name: '–ú–∏—Ä HD',
                extinf: '#EXTINF:-1 tvg-id="mir" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ",–ú–∏—Ä HD'
            },
            {
                name: '–û–¢–† HD',
                extinf: '#EXTINF:-1 tvg-logo="https://iptvx.one/picons/otr.png" tvg-id="otr" group-title="–≠—Ñ–∏—Ä–Ω—ã–µ", –û–¢–† HD'
            },
            {
                name: '–†–ë–ö',
                extinf: '#EXTINF:-1 tvg-id="rbk" group-title="–ù–æ–≤–æ—Å—Ç–∏", –†–ë–ö'
            },
            {
                name: '–°–ø–∞—Å',
                extinf: '#EXTINF:-1 tvg-logo="http://profi-rus.narod.ru/iptv/logo/2s.png" tvg-name="–°–ø–∞—Å –¢–í" group-title="–†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ",–°–ø–∞—Å'
            },
            {
                name: '–ö–∞—Ä—É—Å–µ–ª—å HD',
                extinf: '#EXTINF:-1 tvg-id="karusel" tvg-logo="http://only4.tv/ch/822.png" group-title="–î–µ—Ç—Å–∫–∏–µ", –ö–∞—Ä—É—Å–µ–ª—å HD'
            },
            {
                name: '–ú—É–∑ –¢–í HD',
                extinf: '#EXTINF:-1 tvg-id="muztv" group-title="–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ", –ú—É–∑ –¢–í HD'
            },
            {
                name: '–ú–∞—Ç—á! HD',
                extinf: '#EXTINF:-1 tvg-id="match-tv" group-title="–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ",–ú–∞—Ç—á! HD'
            }
        ];





        // –ü–∞—Ä—Å–∏–Ω–≥ M3U —Ñ–∞–π–ª–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function parseM3UFile(content) {
            const lines = content.split('\n');
            const channels = [];
            let currentChannel = null;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('#EXTINF:')) {
                    // –ü–∞—Ä—Å–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–Ω–∞–ª–µ
                    const tvgIdMatch = line.match(/tvg-id="([^"]*)"/);
                    const tvgLogoMatch = line.match(/tvg-logo="([^"]*)"/);
                    const groupTitleMatch = line.match(/group-title="([^"]*)"/);
                    const nameMatch = line.match(/,(.+)$/);
                    
                    currentChannel = {
                        extinf: line,
                        tvgId: tvgIdMatch ? tvgIdMatch[1] : '',
                        tvgLogo: tvgLogoMatch ? tvgLogoMatch[1] : '',
                        groupTitle: groupTitleMatch ? groupTitleMatch[1] : '',
                        name: nameMatch ? nameMatch[1].trim() : '',
                        url: ''
                    };
                } else if (line && !line.startsWith('#') && currentChannel) {
                    // URL –∫–∞–Ω–∞–ª–∞
                    currentChannel.url = line;
                    channels.push(currentChannel);
                    currentChannel = null;
                }
            }
            
            return channels;
        }



        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ URL –∫–∞–Ω–∞–ª–æ–≤ (—É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function updateChannelUrls(currentChannels, newChannels) {
            let updated = 0;
            const updatedChannels = [];
            const updateLog = [];
            
            if (window.channelDebugMode) {
                console.log('üîÑ === –ù–ê–ß–ê–õ–û –ü–†–û–¶–ï–°–°–ê –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ö–ê–ù–ê–õ–û–í (–¢–û–ß–ù–û–ï –°–û–í–ü–ê–î–ï–ù–ò–ï EXTINF) ===');
                console.log(`üìä –¢–µ–∫—É—â–∏–µ –∫–∞–Ω–∞–ª—ã: ${currentChannels.length}`);
                console.log(`üì• –ù–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã: ${newChannels.length}`);
                console.log('');
            }
            
            for (const current of currentChannels) {
                let channelUpdated = false;
                let updateInfo = '';
                
                if (window.channelDebugMode) {
                    console.log(`üîç === –û–ë–†–ê–ë–û–¢–ö–ê –ö–ê–ù–ê–õ–ê: "${current.name}" ===`);
                    console.log(`üìã EXTINF: ${current.extinf}`);
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ —Ç–æ—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é —Å—Ç—Ä–æ–∫–∏ #EXTINF
                const foundChannel = findChannelByExtinfLine(current.extinf, newChannels);
                
                if (foundChannel) {
                    if (current.url !== foundChannel.url) {
                        const oldUrlShort = current.url.substring(0, 60) + '...';
                        const newUrlShort = foundChannel.url.substring(0, 60) + '...';
                        
                        updateInfo = `‚úÖ –¢–û–ß–ù–û–ï EXTINF —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: "${foundChannel.name}"`;
                        updateLog.push(`üîÑ "${current.name}" ‚Üí "${foundChannel.name}" (100%)`);
                        
                        log(updateInfo);
                        log(`üîÑ URL: ${oldUrlShort} ‚Üí ${newUrlShort}`);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º URL, —Å–æ—Ö—Ä–∞–Ω—è—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–Ω–∞–ª–∞
                        current.url = foundChannel.url;
                        channelUpdated = true;
                        updated++;
                        
                        if (window.channelDebugMode) {
                            console.log(`‚úÖ –û–ë–ù–û–í–õ–ï–ù: URL –∏–∑–º–µ–Ω–µ–Ω`);
                            console.log(`   –°—Ç–∞—Ä—ã–π: ${current.url.substring(0, 80)}...`);
                            console.log(`   –ù–æ–≤—ã–π:  ${foundChannel.url.substring(0, 80)}...`);
                        }
                    } else {
                        updateInfo = `‚úÖ –¢–û–ß–ù–û–ï EXTINF —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: "${foundChannel.name}" - URL –∞–∫—Ç—É–∞–ª–µ–Ω`;
                        log(updateInfo);
                        
                        if (window.channelDebugMode) {
                            console.log(`‚úÖ –ù–ê–ô–î–ï–ù: URL —É–∂–µ –∞–∫—Ç—É–∞–ª–µ–Ω`);
                        }
                    }
                } else {
                    updateInfo = `‚ùå –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ EXTINF –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`;
                    log(updateInfo);
                    
                    if (window.channelDebugMode) {
                        console.log(`‚ùå –ù–ï –ù–ê–ô–î–ï–ù: –Ω–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è EXTINF —Å—Ç—Ä–æ–∫–∏`);
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–Ω–∞–ª –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
                updatedChannels.push(current);
                
                if (window.channelDebugMode) {
                    console.log('');
                }
            }
            
            log(`‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ ${updated} –∫–∞–Ω–∞–ª–æ–≤`);
            
            if (window.channelDebugMode) {
                console.log('üîÑ === –ó–ê–í–ï–†–®–ï–ù–ò–ï –ü–†–û–¶–ï–°–°–ê –û–ë–ù–û–í–õ–ï–ù–ò–Ø ===');
                console.log(`üìä –ò—Ç–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: ${updated} –∫–∞–Ω–∞–ª–æ–≤`);
                if (updateLog.length > 0) {
                    console.log('üìù –ñ—É—Ä–Ω–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:');
                    updateLog.forEach(logEntry => console.log(`   ${logEntry}`));
                }
                console.log('');
            }
            
            return {
                channels: updatedChannels,
                updated: updated
            };
        }

        // –ü–æ–∏—Å–∫ –∫–∞–Ω–∞–ª–∞ –ø–æ —Ç–æ—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é —Å—Ç—Ä–æ–∫–∏ #EXTINF (–∫–∞–∫ –≤ GitHub Actions)
        function findChannelByExtinfLine(extinfLine, sourceChannels) {
            if (window.channelDebugMode) {
                console.log(`üîç –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª—è: ${extinfLine}`);
            }
            
            for (const source of sourceChannels) {
                if (source.extinf === extinfLine) {
                    if (window.channelDebugMode) {
                        console.log(`‚úÖ –¢–û–ß–ù–û–ï —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ!`);
                        console.log(`   –ù–∞–∑–≤–∞–Ω–∏–µ: ${source.name}`);
                        console.log(`   URL: ${source.url}`);
                    }
                    return source;
                }
            }
            
            if (window.channelDebugMode) {
                console.log(`‚ùå –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ù–ï –Ω–∞–π–¥–µ–Ω–æ`);
            }
            return null;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
        async function updateChannelsFromURL() {
            const url = document.getElementById('manual-url').value.trim();
            
            if (!url) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞');
                return;
            }
            
            if (!url.match(/^https?:\/\/.+\.(m3u8?|txt)$/i)) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å .m3u8 –∏–ª–∏ .m3u');
                return;
            }
            
            log(`üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∏–∑: ${url}`);
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                log('üì• –ó–∞–ø—É—Å–∫ GitHub Action –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤...');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –∫–æ—Ç–æ—Ä—ã–π —Å–∫–∞—á–∞–µ—Ç —Ñ–∞–π–ª –∏ –æ–±–Ω–æ–≤–∏—Ç –∫–∞–Ω–∞–ª—ã
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-channels-from-url.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            source_url: url,
                            update_type: 'manual'
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                    
                    if (response.status === 404) {
                        // Workflow –Ω–µ –Ω–∞–π–¥–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π workflow
                        log('‚ö†Ô∏è Specialized workflow –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥...');
                        await updateChannelsViaProxy(url);
                        return;
                    }
                    
                    throw new Error(`GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`);
                }
                
                log('‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤');
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (30-60 —Å–µ–∫—É–Ω–¥)');
                
                // –ñ–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                await waitForChannelsUpdateFromURL();
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ${error.message}`);
                
                // –ü—Ä–æ–±—É–µ–º fallback –º–µ—Ç–æ–¥
                if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                    log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ CORS –ø—Ä–æ–∫—Å–∏...');
                    await updateChannelsViaProxy(url);
                }
            }
        }

        // Fallback –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ CORS –ø—Ä–æ–∫—Å–∏
        async function updateChannelsViaProxy(url) {
            try {
                showProgress(50, '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CORS –ø—Ä–æ–∫—Å–∏...');
                log('üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CORS –ø—Ä–æ–∫—Å–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏...');
                
                // –°–ø–∏—Å–æ–∫ CORS –ø—Ä–æ–∫—Å–∏ –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏
                const corsProxies = [
                    'https://api.allorigins.win/raw?url=',
                    'https://corsproxy.io/?',
                    'https://cors-anywhere.herokuapp.com/',
                    'https://api.codetabs.com/v1/proxy?quest='
                ];
                
                let newContent = null;
                let usedProxy = null;
                
                for (const proxy of corsProxies) {
                    try {
                        showProgress(55, `–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏: ${proxy.includes('allorigins') ? 'AllOrigins' : proxy.includes('corsproxy') ? 'CorsProxy' : proxy.includes('herokuapp') ? 'CorsAnywhere' : 'CodeTabs'}...`);
                        log(`üîó –ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏: ${proxy.includes('allorigins') ? 'AllOrigins' : proxy.includes('corsproxy') ? 'CorsProxy' : proxy.includes('herokuapp') ? 'CorsAnywhere' : 'CodeTabs'}`);
                        
                        const proxyUrl = proxy + encodeURIComponent(url);
                        const response = await fetch(proxyUrl, {
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest'
                            }
                        });
                        
                        if (response.ok) {
                            newContent = await response.text();
                            usedProxy = proxy;
                            log(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏`);
                            break;
                        }
                    } catch (proxyError) {
                        log(`‚ö†Ô∏è –ü—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${proxyError.message}`);
                        continue;
                    }
                }
                
                if (!newContent) {
                    throw new Error('–í—Å–µ CORS –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π URL.');
                }
                
                showProgress(70, '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–∞...');
                
                if (!newContent.includes('#EXTM3U')) {
                    throw new Error('–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º M3U/M3U8');
                }
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤
                showProgress(75, '–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...');
                log('üìä –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...');
                const currentChannels = await getCurrentChannelsFromGitHub();
                if (!currentChannels) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤');
                }
                
                // –ü–∞—Ä—Å–∏–º –æ–±–∞ —Ñ–∞–π–ª–∞
                showProgress(80, '–ê–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤...');
                const currentChannelsParsed = parseM3UFile(currentChannels);
                const newChannelsParsed = parseM3UFile(newContent);
                
                log(`üìä –ê–Ω–∞–ª–∏–∑: —Ç–µ–∫—É—â–∏–µ –∫–∞–Ω–∞–ª—ã ${currentChannelsParsed.length}, –Ω–æ–≤—ã–µ ${newChannelsParsed.length}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫–∏
                showProgress(85, '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –∫–∞–Ω–∞–ª–æ–≤...');
                const updatedResult = updateChannelUrls(currentChannelsParsed, newChannelsParsed);
                
                if (updatedResult.updated === 0) {
                    log('‚ÑπÔ∏è –ü–æ–¥—Ö–æ–¥—è—â–∏–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                    updateChannelsStatus('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ - –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç', 0);
                    showProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ - –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç');
                    setTimeout(() => hideProgress(), 3000);
                    return;
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —á–µ—Ä–µ–∑ GitHub Actions
                showProgress(90, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π...');
                await saveUpdatedChannels(updatedResult);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                updateChannelsStatus(`–û–±–Ω–æ–≤–ª–µ–Ω–æ –∏–∑ ${new URL(url).hostname} (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)`, updatedResult.updated);
                
                showProgress(100, `–ó–∞–≤–µ—Ä—à–µ–Ω–æ! –û–±–Ω–æ–≤–ª–µ–Ω–æ ${updatedResult.updated} –∫–∞–Ω–∞–ª–æ–≤`);
                log(`‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –û–±–Ω–æ–≤–ª–µ–Ω–æ ${updatedResult.updated} –∫–∞–Ω–∞–ª–æ–≤`);
                
                setTimeout(() => hideProgress(), 5000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ fallback –º–µ—Ç–æ–¥–∞: ${error.message}`);
                showProgress(0, `–û—à–∏–±–∫–∞: ${error.message}`, true);
                setTimeout(() => hideProgress(), 5000);
                throw error;
            }
        }

        // –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ GitHub Actions
        async function waitForChannelsUpdateFromURL() {
            const maxAttempts = 12;
            let attempts = 0;
            
            while (attempts < maxAttempts) {
                attempts++;
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 10000)); // 10 —Å–µ–∫—É–Ω–¥
                    
                    const progressPercent = Math.min(40 + (attempts * 5), 95);
                    showProgress(progressPercent, `–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞... (${attempts}/${maxAttempts})`);
                    log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è... (${attempts}/${maxAttempts})`);
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
                    const newChannels = await getCurrentChannelsFromGitHub();
                    
                    if (newChannels) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º textarea
                        document.getElementById('channels-content').value = newChannels;
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ config
                        const config = await loadConfigFromGitHub();
                        if (config && config.channels_config) {
                            const lastUpdated = new Date(config.channels_config.last_updated);
                            const now = new Date();
                            
                            // –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—ã–ª–æ –º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥ - —Å—á–∏—Ç–∞–µ–º —É—Å–ø–µ—à–Ω—ã–º
                            if ((now - lastUpdated) < 120000) {
                                showProgress(100, 'GitHub Actions –∑–∞–≤–µ—Ä—à–∏–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤!');
                                log('‚úÖ GitHub Actions –∑–∞–≤–µ—Ä—à–∏–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤!');
                                setTimeout(() => hideProgress(), 5000);
                                return;
                            }
                        }
                    }
                    
                } catch (error) {
                    log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`);
                }
            }
            
            showProgress(90, '–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions –≤—Ä—É—á–Ω—É—é.');
            log('‚ö†Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions –≤—Ä—É—á–Ω—É—é.');
            setTimeout(() => hideProgress(), 10000);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ
        async function checkSourceChanges() {
            const url = localStorage.getItem('auto-update-url');
            
            if (!url) {
                log('‚ö†Ô∏è –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ');
                return;
            }
            
            log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ: ${url}`);
            
            try {
                // –î–ª—è –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º GitHub Actions –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
                if (!authToken) {
                    log('‚ö†Ô∏è –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω - –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∞');
                    return;
                }
                
                log('ü§ñ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ GitHub Actions...');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-channels-from-url.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            source_url: url,
                            update_type: 'auto-check'
                        }
                    })
                });
                
                if (response.ok) {
                    log('‚úÖ –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞');
                    localStorage.setItem('auto-update-last-check', new Date().toISOString());
                } else {
                    // Fallback - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ö–µ—à–∞
                    await checkSourceChangesViaProxy(url);
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`);
                // Fallback
                await checkSourceChangesViaProxy(url);
            }
        }

        // Fallback –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
        async function checkSourceChangesViaProxy(url) {
            try {
                log('üåê –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏...');
                
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
                const response = await fetch(proxyUrl, {
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const content = await response.text();
                const currentHash = await calculateHash(content);
                const lastHash = localStorage.getItem('auto-update-last-hash');
                
                if (lastHash === currentHash) {
                    log('‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –Ω–µ—Ç');
                    return;
                }
                
                log('üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∑–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è...');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                document.getElementById('manual-url').value = url;
                await updateChannelsFromURL();
                
                localStorage.setItem('auto-update-last-hash', currentHash);
                localStorage.setItem('auto-update-last-check', new Date().toISOString());
                
            } catch (error) {
                log(`‚ö†Ô∏è –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏: ${error.message}`);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ GitHub
        async function loadConfigFromGitHub() {
            try {
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/api/config.json?ref=main&t=${Date.now()}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                if (response.ok) {
                    const fileData = await response.json();
                    return JSON.parse(atob(fileData.content));
                }
                
                return null;
            } catch (error) {
                return null;
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ GitHub
        async function getCurrentChannelsFromGitHub() {
            try {
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/files/channels.m3u8?ref=main&t=${Date.now()}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                if (response.ok) {
                    const fileData = await response.json();
                    return atob(fileData.content);
                }
                
                throw new Error(`HTTP ${response.status}`);
            } catch (error) {
                log(`‚ö†Ô∏è Fallback: –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ GitHub Pages`);
                const response = await fetch(`https://artemon4es.github.io/tv-channels-api/files/channels.m3u8?t=${Date.now()}`);
                if (response.ok) {
                    return await response.text();
                }
                throw error;
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
        async function saveUpdatedChannels(result) {
            // –§–æ—Ä–º–∏—Ä—É–µ–º M3U —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            let content = '#EXTM3U\n';
            
            for (const channel of result.channels) {
                content += `${channel.extinf}\n`;
                content += `${channel.url}\n\n`;
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-channels.yml/dispatches`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'X-GitHub-Api-Version': '2022-11-28',
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    ref: 'main',
                    inputs: {
                        channels_content: content
                    }
                })
            });
            
            if (!response.ok) {
                const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                throw new Error(`GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º textarea
            document.getElementById('channels-content').value = content;
            
            log('‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤');
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        async function setupAutoUpdate() {
            const url = document.getElementById('source-url').value.trim();
            
            if (!url) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');
                return;
            }
            
            if (!url.match(/^https?:\/\/.+\.(m3u8?|txt)$/i)) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å .m3u8 –∏–ª–∏ .m3u');
                return;
            }
            
            log(`‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è: ${url}`);
            
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º URL –≤ localStorage
                localStorage.setItem('auto-update-url', url);
                localStorage.setItem('auto-update-enabled', 'true');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                document.getElementById('auto-update-status').textContent = `–ê–∫—Ç–∏–≤–Ω–æ (${new URL(url).hostname})`;
                document.getElementById('auto-update-status').style.color = '#28a745';
                
                log('‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ');
                log('‚è∞ –°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –≤ 08:00 –∏–ª–∏ 20:00 UTC');
                
                // –ü–µ—Ä–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                await checkSourceChanges();
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ${error.message}`);
            }
        }

        // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function disableAutoUpdate() {
            localStorage.removeItem('auto-update-url');
            localStorage.removeItem('auto-update-enabled');
            localStorage.removeItem('auto-update-last-hash');
            localStorage.removeItem('auto-update-last-check');
            
            document.getElementById('auto-update-status').textContent = '–û—Ç–∫–ª—é—á–µ–Ω–æ';
            document.getElementById('auto-update-status').style.color = '#dc3545';
            document.getElementById('auto-update-info').style.display = 'none';
            
            log('‚èπÔ∏è –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤
        function updateChannelsStatus(message, updatedCount) {
            const statusDiv = document.getElementById('channels-update-status');
            const timestamp = new Date().toLocaleString();
            
            statusDiv.innerHTML = `
                üìä ${message} (${timestamp})
                ${updatedCount ? `<br>üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–Ω–∞–ª–æ–≤: ${updatedCount}` : ''}
            `;
            
            if (updatedCount > 0) {
                statusDiv.style.background = '#d4edda';
                statusDiv.style.color = '#155724';
            } else {
                statusDiv.style.background = '#f8f9fa';
                statusDiv.style.color = '#666';
            }
        }

        // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–µ—à–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
        async function calculateHash(content) {
            const encoder = new TextEncoder();
            const data = encoder.encode(content);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function initializeAutoUpdateStatus() {
            const isEnabled = localStorage.getItem('auto-update-enabled') === 'true';
            const url = localStorage.getItem('auto-update-url');
            const lastCheck = localStorage.getItem('auto-update-last-check');
            
            if (isEnabled && url) {
                document.getElementById('auto-update-status').textContent = `–ê–∫—Ç–∏–≤–Ω–æ (${new URL(url).hostname})`;
                document.getElementById('auto-update-status').style.color = '#28a745';
                document.getElementById('source-url').value = url;
                
                if (lastCheck) {
                    const lastCheckDate = new Date(lastCheck);
                    updateChannelsStatus(`–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞: ${lastCheckDate.toLocaleString()}`, 0);
                }
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
        setInterval(() => {
            const now = new Date();
            const hour = now.getUTCHours();
            const minute = now.getUTCMinutes();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (–≤ 00 –∏ 30 –º–∏–Ω—É—Ç)
            if (minute === 0 || minute === 30) {
                const isEnabled = localStorage.getItem('auto-update-enabled') === 'true';
                if (isEnabled) {
                    log('‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...');
                    checkSourceChanges();
                }
            }
        }, 60000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ URL –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        async function testSourceURL() {
            const url = document.getElementById('source-url').value.trim();
            
            if (!url) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                return;
            }
            
            log(`üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ URL: ${url}`);
            
            try {
                const result = await testURLAccess(url);
                
                if (result.success) {
                    log(`‚úÖ URL –¥–æ—Å—Ç—É–ø–µ–Ω: ${result.channels} –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞–π–¥–µ–Ω–æ`);
                    showAutoUpdateInfo(`URL –¥–æ—Å—Ç—É–ø–µ–Ω ‚Ä¢ ${result.channels} –∫–∞–Ω–∞–ª–æ–≤ ‚Ä¢ –†–∞–∑–º–µ—Ä: ${result.size}`, 'success');
                } else {
                    log(`‚ùå URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${result.error}`);
                    showAutoUpdateInfo(`URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${result.error}`, 'error');
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`);
                showAutoUpdateInfo(`–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`, 'error');
            }
        }

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ URL –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        async function testManualURL() {
            const url = document.getElementById('manual-url').value.trim();
            
            if (!url) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                return;
            }
            
            log(`üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ URL: ${url}`);
            
            try {
                const result = await testURLAccess(url);
                
                if (result.success) {
                    log(`‚úÖ URL –¥–æ—Å—Ç—É–ø–µ–Ω: ${result.channels} –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞–π–¥–µ–Ω–æ`);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –Ω–∞—à–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏
                    const matches = await findChannelMatches(result.content);
                    log(`üéØ –ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –Ω–∞—à–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏: ${matches}`);
                    
                    showProgress(100, `URL –¥–æ—Å—Ç—É–ø–µ–Ω ‚Ä¢ ${result.channels} –∫–∞–Ω–∞–ª–æ–≤ ‚Ä¢ –°–æ–≤–ø–∞–¥–µ–Ω–∏–π: ${matches}`);
                    setTimeout(() => hideProgress(), 3000);
                } else {
                    log(`‚ùå URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${result.error}`);
                    showProgress(0, `URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${result.error}`, true);
                    setTimeout(() => hideProgress(), 5000);
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`);
                showProgress(0, `–û—à–∏–±–∫–∞: ${error.message}`, true);
                setTimeout(() => hideProgress(), 5000);
            }
        }

        // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è URL
        async function testURLAccess(url) {
            if (!url.match(/^https?:\/\/.+\.(m3u8?|txt)$/i)) {
                throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å .m3u8 –∏–ª–∏ .m3u');
            }
            
            try {
                // –ü—Ä–æ–±—É–µ–º –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
                const response = await fetch(url, { 
                    method: 'HEAD',
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                });
                
                if (response.ok) {
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                    const fullResponse = await fetch(url);
                    const content = await fullResponse.text();
                    
                    if (!content.includes('#EXTM3U')) {
                        throw new Error('–§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º M3U/M3U8');
                    }
                    
                    const channels = (content.match(/#EXTINF:/g) || []).length;
                    const sizeKB = Math.round(content.length / 1024);
                    
                    return {
                        success: true,
                        channels: channels,
                        size: `${sizeKB} KB`,
                        content: content
                    };
                }
            } catch (directError) {
                log(`‚ö†Ô∏è –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –Ω–µ—É–¥–∞—á–µ–Ω, –ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏: ${directError.message}`);
            }
            
            // –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ CORS –ø—Ä–æ–∫—Å–∏
            const corsProxies = [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest='
            ];
            
            for (const proxy of corsProxies) {
                try {
                    const proxyUrl = proxy + encodeURIComponent(url);
                    const response = await fetch(proxyUrl, {
                        headers: { 'X-Requested-With': 'XMLHttpRequest' }
                    });
                    
                    if (response.ok) {
                        const content = await response.text();
                        
                        if (!content.includes('#EXTM3U')) {
                            throw new Error('–§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º M3U/M3U8');
                        }
                        
                        const channels = (content.match(/#EXTINF:/g) || []).length;
                        const sizeKB = Math.round(content.length / 1024);
                        
                        return {
                            success: true,
                            channels: channels,
                            size: `${sizeKB} KB`,
                            content: content
                        };
                    }
                } catch (proxyError) {
                    continue;
                }
            }
            
            return {
                success: false,
                error: 'URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–∫—Å–∏'
            };
        }

        // –ü–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∫–∞–Ω–∞–ª–æ–≤ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        async function findChannelMatches(content) {
            try {
                const sourceChannels = parseM3UFile(content);
                let matches = 0;
                
                // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –Ω–∞—à–∏–º —Ü–µ–ª–µ–≤—ã–º –∫–∞–Ω–∞–ª–∞–º
                for (const targetChannel of TARGET_CHANNELS) {
                    // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ EXTINF —Å—Ç—Ä–æ–∫–∏
                    const foundChannel = findChannelByExtinfLine(targetChannel.extinf, sourceChannels);
                    if (foundChannel) {
                        matches++;
                    }
                }
                
                return matches;
            } catch (error) {
                return 0;
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function showAutoUpdateInfo(message, type = 'info') {
            const infoDiv = document.getElementById('auto-update-info');
            const detailsSpan = document.getElementById('auto-update-details');
            
            detailsSpan.textContent = message;
            infoDiv.style.display = 'block';
            
            if (type === 'success') {
                infoDiv.style.background = '#d4edda';
                infoDiv.style.color = '#155724';
            } else if (type === 'error') {
                infoDiv.style.background = '#f8d7da';
                infoDiv.style.color = '#721c24';
            } else {
                infoDiv.style.background = '#e9ecef';
                infoDiv.style.color = '#666';
            }
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                infoDiv.style.display = 'none';
            }, 10000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
        function showProgress(percent, message, isError = false) {
            const progressDiv = document.getElementById('manual-progress');
            const progressBar = document.getElementById('manual-progress-bar');
            const progressText = document.getElementById('manual-progress-text');
            
            progressDiv.style.display = 'block';
            progressBar.style.width = percent + '%';
            progressText.textContent = message;
            
            if (isError) {
                progressBar.style.background = '#dc3545';
            } else if (percent === 100) {
                progressBar.style.background = '#28a745';
            } else {
                progressBar.style.background = '#007bff';
            }
        }

        // –°–∫—Ä—ã—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
        function hideProgress() {
            document.getElementById('manual-progress').style.display = 'none';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
        async function updateChannelsFromURL() {
            const url = document.getElementById('manual-url').value.trim();
            
            if (!url) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞');
                return;
            }
            
            if (!url.match(/^https?:\/\/.+\.(m3u8?|txt)$/i)) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å .m3u8 –∏–ª–∏ .m3u');
                return;
            }
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            const updateBtn = document.getElementById('manual-update-btn');
            updateBtn.disabled = true;
            updateBtn.textContent = '‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...';
            
            showProgress(10, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è...');
            
            log(`üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∏–∑: ${url}`);
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
                if (!authToken) {
                    throw new Error('–¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                }
                
                showProgress(20, '–ó–∞–ø—É—Å–∫ GitHub Action...');
                log('üì• –ó–∞–ø—É—Å–∫ GitHub Action –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤...');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º GitHub Action –∫–æ—Ç–æ—Ä—ã–π —Å–∫–∞—á–∞–µ—Ç —Ñ–∞–π–ª –∏ –æ–±–Ω–æ–≤–∏—Ç –∫–∞–Ω–∞–ª—ã
                const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/actions/workflows/update-channels-from-url.yml/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'X-GitHub-Api-Version': '2022-11-28',
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            source_url: url,
                            update_type: 'manual'
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                    
                    if (response.status === 404) {
                        // Workflow –Ω–µ –Ω–∞–π–¥–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π workflow
                        showProgress(30, '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ fallback –º–µ—Ç–æ–¥...');
                        log('‚ö†Ô∏è Specialized workflow –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥...');
                        await updateChannelsViaProxy(url);
                        return;
                    }
                    
                    throw new Error(`GitHub Actions –æ—à–∏–±–∫–∞: ${errorData.message}`);
                }
                
                showProgress(40, 'GitHub Action –∑–∞–ø—É—â–µ–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...');
                log('‚úÖ GitHub Action –∑–∞–ø—É—â–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤');
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... (30-60 —Å–µ–∫—É–Ω–¥)');
                
                // –ñ–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                await waitForChannelsUpdateFromURL();
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ${error.message}`);
                
                // –ü—Ä–æ–±—É–µ–º fallback –º–µ—Ç–æ–¥
                if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                    showProgress(30, '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ CORS –ø—Ä–æ–∫—Å–∏...');
                    log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ CORS –ø—Ä–æ–∫—Å–∏...');
                    await updateChannelsViaProxy(url);
                } else {
                    showProgress(0, `–û—à–∏–±–∫–∞: ${error.message}`, true);
                    setTimeout(() => hideProgress(), 5000);
                }
            } finally {
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
                updateBtn.disabled = false;
                updateBtn.textContent = 'üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–Ω–∞–ª—ã';
            }
        }
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–∞–Ω–∞–ª–æ–≤
        function toggleChannelDebug() {
            window.channelDebugMode = !window.channelDebugMode;
            const btn = document.getElementById('debug-btn');
            
            if (window.channelDebugMode) {
                btn.innerHTML = 'üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –í–ö–õ';
                btn.style.background = '#28a745';
                log('üîß –†–µ–∂–∏–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–∞–Ω–∞–ª–æ–≤ –≤–∫–ª—é—á–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.');
            } else {
                btn.innerHTML = 'üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞';
                btn.style.background = '#6c757d';
                log('üîß –†–µ–∂–∏–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–∞–Ω–∞–ª–æ–≤ –æ—Ç–∫–ª—é—á–µ–Ω.');
            }
        }

        // ===== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–°–¢–ê–í–ö–û–ô =====
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞—Å—Ç–∞–≤–∫–µ
        function updateSplashInfo(config) {
            if (config && config.splash_config) {
                const versionElement = document.getElementById('splash-version');
                const lastUpdatedElement = document.getElementById('splash-last-updated');
                
                if (versionElement) {
                    versionElement.textContent = config.splash_config.version || 1;
                }
                
                if (lastUpdatedElement) {
                    const lastUpdated = config.splash_config.last_updated || new Date().toISOString();
                    lastUpdatedElement.textContent = new Date(lastUpdated).toLocaleString('ru-RU');
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞—Å—Ç–∞–≤–∫–µ
        async function loadSplashInfo() {
            try {
                log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞—Å—Ç–∞–≤–∫–µ...');
                await loadCurrentConfig();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –Ω–æ–≤—ã–º timestamp
                const timestamp = Date.now();
                const logoImg = document.getElementById('current-splash-logo');
                const backgroundImg = document.getElementById('current-splash-background');
                
                if (logoImg) {
                    logoImg.src = `https://artemon4es.github.io/tv-channels-api/files/splash/logo_app.png?t=${timestamp}`;
                }
                
                if (backgroundImg) {
                    backgroundImg.src = `https://artemon4es.github.io/tv-channels-api/files/splash/background.png?t=${timestamp}`;
                }
                
                log('‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞—Å—Ç–∞–≤–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞—Å—Ç–∞–≤–∫–µ: ${error.message}`);
            }
        }
        
        // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        document.getElementById('splash-logo-file')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('splash-logo-preview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('splash-background-file')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('splash-background-preview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞—Å—Ç–∞–≤–∫–∏
        async function uploadSplashImages() {
            const logoFile = document.getElementById('splash-logo-file').files[0];
            const backgroundFile = document.getElementById('splash-background-file').files[0];
            
            if (!logoFile && !backgroundFile) {
                log('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
                return;
            }
            
            if (!authToken) {
                log('‚ùå –¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.');
                return;
            }
            
            const uploadBtn = document.getElementById('upload-splash-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                log('üé® –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞—Å—Ç–∞–≤–∫–∏...');
                
                let uploadedFiles = [];
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–≥–æ—Ç–∏–ø
                if (logoFile) {
                    log('üì± –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞...');
                    await uploadImageToGitHub(logoFile, 'files/splash/logo_app.png');
                    uploadedFiles.push('–ª–æ–≥–æ—Ç–∏–ø');
                    log('‚úÖ –õ–æ–≥–æ—Ç–∏–ø –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ–Ω
                if (backgroundFile) {
                    log('üåÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–∞...');
                    await uploadImageToGitHub(backgroundFile, 'files/splash/background.png');
                    uploadedFiles.push('—Ñ–æ–Ω');
                    log('‚úÖ –§–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                
                log(`üéâ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞—Å—Ç–∞–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: ${uploadedFiles.join(', ')}`);
                log('‚è≥ GitHub Action –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –≤–µ—Ä—Å–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
                log('üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
                document.getElementById('splash-logo-file').value = '';
                document.getElementById('splash-background-file').value = '';
                document.getElementById('splash-logo-preview').style.display = 'none';
                document.getElementById('splash-background-preview').style.display = 'none';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
                setTimeout(loadSplashInfo, 3000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'üé® –û–±–Ω–æ–≤–∏—Ç—å –∑–∞—Å—Ç–∞–≤–∫—É';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ GitHub
        async function uploadImageToGitHub(file, path) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const base64Content = e.target.result.split(',')[1];
                        
                        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π SHA —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
                        let sha = null;
                        try {
                            const getResponse = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/${path}`, {
                                headers: {
                                    'Authorization': `Bearer ${authToken}`,
                                    'X-GitHub-Api-Version': '2022-11-28',
                                    'Accept': 'application/vnd.github.v3+json'
                                }
                            });
                            
                            if (getResponse.ok) {
                                const fileData = await getResponse.json();
                                sha = fileData.sha;
                            }
                        } catch (e) {
                            // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
                        }
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª
                        const uploadData = {
                            message: `üé® Update splash image: ${path.split('/').pop()}`,
                            content: base64Content,
                            branch: 'main'
                        };
                        
                        if (sha) {
                            uploadData.sha = sha;
                        }
                        
                        const response = await fetch(`https://api.github.com/repos/artemon4es/tv-channels-api/contents/${path}`, {
                            method: 'PUT',
                            headers: {
                                'Authorization': `Bearer ${authToken}`,
                                'X-GitHub-Api-Version': '2022-11-28',
                                'Accept': 'application/vnd.github.v3+json',
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(uploadData)
                        });
                        
                        if (response.ok) {
                            resolve();
                        } else {
                            const errorData = await response.json();
                            reject(new Error(`GitHub API –æ—à–∏–±–∫–∞: ${errorData.message}`));
                        }
                        
                    } catch (error) {
                        reject(error);
                    }
                };
                
                reader.onerror = () => reject(new Error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞'));
                reader.readAsDataURL(file);
            });
        }

        // ===== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –õ–û–ì–û–¢–ò–ü–ê–ú–ò –ö–ê–ù–ê–õ–û–í =====
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö –∫–∞–Ω–∞–ª–æ–≤
        function updateChannelLogosInfo(config) {
            if (config && config.channel_logos_config) {
                const versionElement = document.getElementById('logos-version');
                const lastUpdatedElement = document.getElementById('logos-last-updated');
                
                if (versionElement) {
                    versionElement.textContent = config.channel_logos_config.version || 1;
                }
                
                if (lastUpdatedElement) {
                    const lastUpdated = config.channel_logos_config.last_updated || new Date().toISOString();
                    lastUpdatedElement.textContent = new Date(lastUpdated).toLocaleString('ru-RU');
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö –∫–∞–Ω–∞–ª–æ–≤
        async function loadChannelLogosInfo() {
            try {
                log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö –∫–∞–Ω–∞–ª–æ–≤...');
                await loadCurrentConfig();
                await loadCurrentChannelLogos();
                log('‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö –∫–∞–Ω–∞–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ–≥–æ—Ç–∏–ø–∞—Ö: ${error.message}`);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–∏—Ö –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤
        async function loadCurrentChannelLogos() {
            try {
                const logosContainer = document.getElementById('current-channel-logos');
                logosContainer.innerHTML = '<div style="text-align: center; color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';
                
                const logoNames = [
                    'rossiya-1.png', 'ntv.png', 'rossiya-24.png', 'kultura.png',
                    'tnt.png', 'sts.png', 'tv-3.png', 'tvzvezda.png', 'ren_tv.png',
                    'tvc.png', '5-kanal.png', 'domashniy.png', 'friday.png', 'mir.png',
                    'otr.png', 'rbc.png', 'muz.png', 'karusel.png', 'spas.png', 'ortl.png',
                    'match_tv.png' // –î–æ–±–∞–≤–ª–µ–Ω –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –ª–æ–≥–æ—Ç–∏–ø
                ];
                
                const timestamp = Date.now();
                let logosHtml = '';
                
                for (const logoName of logoNames) {
                    const logoUrl = `https://artemon4es.github.io/tv-channels-api/files/channel-logos/${logoName}?t=${timestamp}`;
                    const channelName = logoName.replace('.png', '').replace('_', ' ').toUpperCase();
                    
                    logosHtml += `
                        <div style="text-align: center; padding: 5px;">
                            <img src="${logoUrl}" alt="${channelName}" 
                                 style="width: 80px; height: 60px; object-fit: contain; border: 1px solid #ddd; border-radius: 4px; background: white;"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div style="display: none; width: 80px; height: 60px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa; 
                                        display: flex; align-items: center; justify-content: center; font-size: 10px; color: #666;">
                                –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                            </div>
                            <div style="font-size: 10px; margin-top: 2px; color: #666;">${channelName}</div>
                        </div>
                    `;
                }
                
                logosContainer.innerHTML = logosHtml;
                log('‚úÖ –°–ø–∏—Å–æ–∫ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤: ${error.message}`);
                document.getElementById('current-channel-logos').innerHTML = 
                    '<div style="text-align: center; color: red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤
        async function uploadChannelLogos() {
            const filesInput = document.getElementById('channel-logos-files');
            const files = filesInput.files;
            
            if (files.length === 0) {
                log('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
                return;
            }
            
            if (!authToken) {
                log('‚ùå –¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–æ–≤.');
                return;
            }
            
            const uploadBtn = document.getElementById('upload-logos-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                log(`üì∫ –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ ${files.length} –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤...`);
                
                let uploadedCount = 0;
                let errorCount = 0;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    try {
                        log(`üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ ${file.name}...`);
                        await uploadImageToGitHub(file, `files/channel-logos/${file.name}`);
                        uploadedCount++;
                        log(`‚úÖ ${file.name} –∑–∞–≥—Ä—É–∂–µ–Ω`);
                    } catch (error) {
                        errorCount++;
                        log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${file.name}: ${error.message}`);
                    }
                }
                
                log(`üéâ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: ${uploadedCount} —É—Å–ø–µ—à–Ω–æ, ${errorCount} –æ—à–∏–±–æ–∫`);
                log('‚è≥ GitHub Action –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –≤–µ—Ä—Å–∏—é –ª–æ–≥–æ—Ç–∏–ø–æ–≤...');
                log('üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
                filesInput.value = '';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
                setTimeout(loadChannelLogosInfo, 3000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–æ–≤: ${error.message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'üì∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø—ã';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞ –∫–∞–Ω–∞–ª–∞
        async function uploadSingleChannelLogo() {
            const channelName = document.getElementById('single-logo-channel').value.trim();
            const fileInput = document.getElementById('single-logo-file');
            const file = fileInput.files[0];
            
            if (!channelName) {
                log('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞');
                return;
            }
            
            if (!file) {
                log('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –ª–æ–≥–æ—Ç–∏–ø–∞');
                return;
            }
            
            if (!authToken) {
                log('‚ùå –¢–æ–∫–µ–Ω GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–∞.');
                return;
            }
            
            try {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞
                const fileName = generateLogoFileName(channelName);
                
                log(`üéØ –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è –∫–∞–Ω–∞–ª–∞ "${channelName}" –∫–∞–∫ ${fileName}...`);
                
                await uploadImageToGitHub(file, `files/channel-logos/${fileName}`);
                
                log(`‚úÖ –õ–æ–≥–æ—Ç–∏–ø –¥–ª—è –∫–∞–Ω–∞–ª–∞ "${channelName}" –∑–∞–≥—Ä—É–∂–µ–Ω –∫–∞–∫ ${fileName}`);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º mapping –¥–ª—è —ç—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞
                await updateChannelLogoMapping(channelName, fileName);
                
                log('‚è≥ GitHub Action –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –≤–µ—Ä—Å–∏—é –ª–æ–≥–æ—Ç–∏–ø–æ–≤...');
                log('üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
                document.getElementById('single-logo-channel').value = '';
                fileInput.value = '';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
                setTimeout(loadChannelLogosInfo, 3000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–∞: ${error.message}`);
            }
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è mapping –∫–∞–Ω–∞–ª–æ–≤
        let channelLogoMapping = {};
        let autoGenerationRules = {};
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ mapping –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ GitHub
        async function loadChannelLogoMapping() {
            try {
                const response = await fetch('https://artemon4es.github.io/tv-channels-api/files/channel-logo-mapping.json');
                if (response.ok) {
                    const mappingData = await response.json();
                    channelLogoMapping = mappingData.mappings || {};
                    autoGenerationRules = mappingData.auto_generation_rules || {};
                    console.log('Channel logo mapping –∑–∞–≥—Ä—É–∂–µ–Ω:', Object.keys(channelLogoMapping).length, '–∑–∞–ø–∏—Å–µ–π');
                    return true;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ channel logo mapping:', error);
            }
            return false;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        function generateLogoFileNameFromRules(channelName) {
            try {
                if (!autoGenerationRules || Object.keys(autoGenerationRules).length === 0) {
                    return null;
                }
                
                let name = channelName.toLowerCase().trim();
                
                // –£–±–∏—Ä–∞–µ–º HD –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–æ –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö
                if (autoGenerationRules.remove_hd) {
                    name = name.replace(' hd', '').replace('hd', '');
                }
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–º–µ–Ω—ã
                if (autoGenerationRules.replacements) {
                    for (const [key, value] of Object.entries(autoGenerationRules.replacements)) {
                        name = name.replace(new RegExp(key, 'g'), value);
                    }
                }
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–æ–≤
                if (autoGenerationRules.char_replacements) {
                    for (const [key, value] of Object.entries(autoGenerationRules.char_replacements)) {
                        name = name.replace(new RegExp(key.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), value);
                    }
                }
                
                // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
                name = name.replace(/^_+|_+$/g, '');
                const extension = autoGenerationRules.file_extension || '.png';
                
                return name ? name + extension : null;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è', channelName, ':', error);
                return null;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ mapping –ª–æ–≥–æ—Ç–∏–ø–æ–≤
        async function updateChannelLogoMapping(channelName, logoFileName) {
            try {
                log(`üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ mapping –¥–ª—è –∫–∞–Ω–∞–ª–∞ "${channelName}" -> "${logoFileName}"`);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–π mapping
                const response = await fetch('https://artemon4es.github.io/tv-channels-api/files/channel-logo-mapping.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const mappingData = await response.json();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
                const normalizedChannelName = channelName.toLowerCase().trim();
                mappingData.mappings[normalizedChannelName] = logoFileName;
                mappingData.last_updated = new Date().toISOString();
                mappingData.version = (mappingData.version || 1) + 1;
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
                log(`‚úÖ Mapping –æ–±–Ω–æ–≤–ª–µ–Ω: "${normalizedChannelName}" -> "${logoFileName}"`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
                channelLogoMapping = mappingData.mappings;
                
                return true;
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è mapping: ${error.message}`);
                return false;
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞
        function generateLogoFileName(channelName) {
            const name = channelName.toLowerCase().trim();
            
            // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º mapping
            if (channelLogoMapping[name]) {
                return channelLogoMapping[name];
            }
            
            // 2. –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º mapping
            for (const [channelPattern, logoFile] of Object.entries(channelLogoMapping)) {
                if (name.includes(channelPattern.replace(' hd', '')) || channelPattern.replace(' hd', '').includes(name)) {
                    return logoFile;
                }
            }
            
            // 3. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ mapping, –ø—ã—Ç–∞–µ–º—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            if (autoGenerationRules && Object.keys(autoGenerationRules).length > 0) {
                return generateLogoFileNameFromRules(name);
            }
            
            // 4. Fallback: –µ—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤–∏–ª –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null
            console.log('–õ–æ–≥–æ—Ç–∏–ø –¥–ª—è –∫–∞–Ω–∞–ª–∞', channelName, '–Ω–µ –Ω–∞–π–¥–µ–Ω');
            return null;
        }

        // –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –∏—Ö –ª–æ–≥–æ—Ç–∏–ø–æ–≤
        async function loadAllChannelsAnalysis() {
            try {
                log('üîç –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –ª–æ–≥–æ—Ç–∏–ø–æ–≤...');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π mapping –∫–∞–Ω–∞–ª–æ–≤
                await loadChannelLogoMapping();
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–∞–Ω–∞–ª—ã
                const channels = await getCurrentChannelsFromGitHub();
                const channelList = parseM3UFile(channels);
                
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–Ω–∞–ª—ã
                const channelsWithoutLogos = [];
                const channelsWithLogos = [];
                
                channelList.forEach(channel => {
                    const logoFileName = generateLogoFileName(channel.name);
                    if (logoFileName === null) {
                        channelsWithoutLogos.push(channel);
                    } else {
                        channelsWithLogos.push({...channel, logoFile: logoFileName});
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                document.getElementById('total-channels-count').textContent = channelList.length;
                document.getElementById('channels-without-logos-count').textContent = channelsWithoutLogos.length;
                document.getElementById('channels-with-logos-count').textContent = channelsWithLogos.length;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                updateChannelsAnalysisDisplay(channelsWithoutLogos, channelsWithLogos);
                populateChannelSelectWithAll(channelList); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –í–°–ï –∫–∞–Ω–∞–ª—ã –¥–ª—è –≤—ã–±–æ—Ä–∞
                
                log(`‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: ${channelList.length} –∫–∞–Ω–∞–ª–æ–≤ (${channelsWithLogos.length} —Å –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏, ${channelsWithoutLogos.length} –±–µ–∑)`);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–Ω–∞–ª–æ–≤: ${error.message}`);
                document.getElementById('channels-without-logos-count').textContent = '–û—à–∏–±–∫–∞';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–Ω–∞–ª–æ–≤
        function updateChannelsAnalysisDisplay(channelsWithoutLogos, channelsWithLogos) {
            const listElement = document.getElementById('channels-analysis-list');
            const contentElement = document.getElementById('channels-analysis-content');
            
            let html = '<div style="margin-bottom: 15px;">';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–Ω–∞–ª—ã –±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–æ–≤
            if (channelsWithoutLogos.length > 0) {
                html += '<h5 style="color: #dc3545; margin-bottom: 10px;">‚ùå –ö–∞–Ω–∞–ª—ã –±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–æ–≤:</h5>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; margin-bottom: 15px;">';
                
                channelsWithoutLogos.forEach(channel => {
                    html += `
                        <div style="padding: 8px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px;">
                            <div style="font-weight: bold; font-size: 12px; color: #721c24;">${channel.name}</div>
                            <div style="font-size: 10px; color: #721c24;">–ì—Ä—É–ø–ø–∞: ${channel.group || '–ë–µ–∑ –≥—Ä—É–ø–ø—ã'}</div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–Ω–∞–ª—ã —Å –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏
            if (channelsWithLogos.length > 0) {
                html += '<h5 style="color: #28a745; margin-bottom: 10px;">‚úÖ –ö–∞–Ω–∞–ª—ã —Å –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏:</h5>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px;">';
                
                channelsWithLogos.forEach(channel => {
                    html += `
                        <div style="padding: 8px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px;">
                            <div style="font-weight: bold; font-size: 12px; color: #155724;">${channel.name}</div>
                            <div style="font-size: 10px; color: #155724;">–õ–æ–≥–æ—Ç–∏–ø: ${channel.logoFile}</div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            html += '</div>';
            contentElement.innerHTML = html;
            listElement.style.display = 'block';
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –í–°–ï–ú–ò –∫–∞–Ω–∞–ª–∞–º–∏
        function populateChannelSelectWithAll(allChannels) {
            const selectElement = document.getElementById('single-logo-channel');
            
            // –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–ø—Ü–∏–∏ (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–π)
            selectElement.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª...</option>';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –í–°–ï –∫–∞–Ω–∞–ª—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞ –ª–æ–≥–æ—Ç–∏–ø–∞
            allChannels.forEach(channel => {
                const logoFileName = generateLogoFileName(channel.name);
                const hasLogo = logoFileName !== null;
                const statusIcon = hasLogo ? '‚úÖ' : '‚ùå';
                const statusText = hasLogo ? `(–ª–æ–≥–æ: ${logoFileName})` : '(–±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–∞)';
                
                const option = document.createElement('option');
                option.value = channel.name;
                option.textContent = `${statusIcon} ${channel.name} ${statusText}`;
                selectElement.appendChild(option);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—É—é –æ–ø—Ü–∏—é
            const infoOption = document.createElement('option');
            infoOption.value = '';
            infoOption.textContent = `üìä –í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤: ${allChannels.length}`;
            infoOption.disabled = true;
            selectElement.appendChild(infoOption);
        }
        
        // –ü–∞—Ä—Å–∏–Ω–≥ M3U —Ñ–∞–π–ª–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤
        function parseM3UFile(content) {
            const lines = content.split('\n');
            const channels = [];
            let currentChannel = null;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('#EXTINF:')) {
                    // –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –∏–∑ —Å—Ç—Ä–æ–∫–∏ #EXTINF
                    const nameMatch = line.match(/,(.+)$/);
                    const groupMatch = line.match(/group-title="([^"]+)"/);
                    
                    if (nameMatch) {
                        currentChannel = {
                            name: nameMatch[1].trim(),
                            group: groupMatch ? groupMatch[1] : null,
                            extinf: line
                        };
                    }
                } else if (line && !line.startsWith('#') && currentChannel) {
                    currentChannel.url = line;
                    channels.push(currentChannel);
                    currentChannel = null;
                }
            }
            
            return channels;
        }

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è realtime —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let originalRealtimeContent = '';
        let hasRealtimeChanges = false;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è realtime —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        async function loadForRealtimeEditing() {
            try {
                log('üìù –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è realtime —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...');
                
                const content = await getCurrentChannelsFromGitHub();
                originalRealtimeContent = content;
                
                const editor = document.getElementById('realtime-channels-editor');
                const statusElement = document.getElementById('realtime-edit-status');
                const infoElement = document.getElementById('realtime-edit-info');
                
                // –í–∫–ª—é—á–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                editor.disabled = false;
                editor.value = content;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                statusElement.innerHTML = '‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å.';
                statusElement.style.color = '#28a745';
                infoElement.style.display = 'block';
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
                setupRealtimeTracking();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateEditorStats();
                
                log('‚úÖ Realtime —Ä–µ–¥–∞–∫—Ç–æ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`);
                document.getElementById('realtime-edit-status').innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                document.getElementById('realtime-edit-status').style.color = '#dc3545';
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ realtime
        function setupRealtimeTracking() {
            const editor = document.getElementById('realtime-channels-editor');
            const statusElement = document.getElementById('realtime-edit-status');
            const saveBtn = document.getElementById('realtime-save-btn');
            
            editor.addEventListener('input', () => {
                const currentContent = editor.value;
                hasRealtimeChanges = currentContent !== originalRealtimeContent;
                
                // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
                localStorage.setItem('realtime-editor-content', currentContent);
                localStorage.setItem('realtime-editor-timestamp', Date.now());
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                if (hasRealtimeChanges) {
                    statusElement.innerHTML = '‚ö†Ô∏è –ï—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                    statusElement.style.color = '#ffc107';
                    saveBtn.disabled = false;
                } else {
                    statusElement.innerHTML = '‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
                    statusElement.style.color = '#28a745';
                    saveBtn.disabled = true;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateEditorStats();
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage
            const savedContent = localStorage.getItem('realtime-editor-content');
            const savedTimestamp = localStorage.getItem('realtime-editor-timestamp');
            
            if (savedContent && savedTimestamp) {
                const timeDiff = Date.now() - parseInt(savedTimestamp);
                // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –º–µ–Ω–µ–µ 24 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
                if (timeDiff < 24 * 60 * 60 * 1000) {
                    const savedTime = new Date(parseInt(savedTimestamp)).toLocaleString();
                    const useSaved = confirm(`–ù–∞–π–¥–µ–Ω—ã –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç ${savedTime}. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö?`);
                    
                    if (useSaved) {
                        editor.value = savedContent;
                        hasRealtimeChanges = savedContent !== originalRealtimeContent;
                        
                        if (hasRealtimeChanges) {
                            statusElement.innerHTML = 'üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                            statusElement.style.color = '#ffc107';
                            saveBtn.disabled = false;
                        }
                        
                        updateEditorStats();
                        log('üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞');
                    }
                }
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ realtime –∏–∑–º–µ–Ω–µ–Ω–∏–π
        async function saveRealtimeChanges() {
            const editor = document.getElementById('realtime-channels-editor');
            const content = editor.value;
            
            if (!content.includes('#EXTM3U')) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö. –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å #EXTM3U');
                return;
            }
            
            if (!hasRealtimeChanges) {
                log('‚ÑπÔ∏è –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                return;
            }
            
            try {
                log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ GitHub Actions...');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ GitHub Actions, –º–∏–Ω—É—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π textarea
                await saveChannels(content);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                originalRealtimeContent = content;
                hasRealtimeChanges = false;
                
                document.getElementById('realtime-edit-status').innerHTML = '‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
                document.getElementById('realtime-edit-status').style.color = '#28a745';
                document.getElementById('realtime-save-btn').disabled = true;
                
                // –û—á–∏—â–∞–µ–º localStorage
                localStorage.removeItem('realtime-editor-content');
                localStorage.removeItem('realtime-editor-timestamp');
                
                log('‚úÖ Realtime –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è realtime –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${error.message}`);
                alert(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${error.message}`);
            }
        }
        
        // –û—Ç–º–µ–Ω–∞ realtime –∏–∑–º–µ–Ω–µ–Ω–∏–π
        function discardRealtimeChanges() {
            if (hasRealtimeChanges && !confirm('–û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                return;
            }
            
            const editor = document.getElementById('realtime-channels-editor');
            const statusElement = document.getElementById('realtime-edit-status');
            const saveBtn = document.getElementById('realtime-save-btn');
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            editor.value = originalRealtimeContent;
            hasRealtimeChanges = false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            statusElement.innerHTML = '‚Ü∂ –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–º–µ–Ω–µ–Ω—ã';
            statusElement.style.color = '#6c757d';
            saveBtn.disabled = true;
            
            // –û—á–∏—â–∞–µ–º localStorage
            localStorage.removeItem('realtime-editor-content');
            localStorage.removeItem('realtime-editor-timestamp');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateEditorStats();
            
            log('‚Ü∂ Realtime –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–º–µ–Ω–µ–Ω—ã');
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        function updateEditorStats() {
            const editor = document.getElementById('realtime-channels-editor');
            const content = editor.value;
            
            // –ü–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤
            const charCount = content.length;
            document.getElementById('editor-char-count').textContent = charCount.toLocaleString();
            
            // –ü–æ–¥—Å—á–µ—Ç —Å—Ç—Ä–æ–∫
            const lineCount = content.split('\n').length;
            document.getElementById('editor-line-count').textContent = lineCount.toLocaleString();
            
            // –ü–æ–¥—Å—á–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ (—Å—Ç—Ä–æ–∫–∏ –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å #EXTINF)
            const channelCount = (content.match(/#EXTINF:/g) || []).length;
            document.getElementById('editor-channel-count').textContent = channelCount.toLocaleString();
        }

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –£–°–¢–†–û–ô–°–¢–í–ê–ú–ò =====
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadDeviceList() {
            try {
                log('üñ•Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤...');
                
                const response = await fetch('https://artemon4es.github.io/tv-channels-api/api/devices/config.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const deviceConfig = await response.json();
                const devices = deviceConfig.devices || {};
                const stats = deviceConfig.stats || {
                    total_devices: 0,
                    online_devices: 0,
                    enabled_devices: 0,
                    disabled_devices: 0
                };
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateDeviceStats(stats);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                displayDeviceList(devices, deviceConfig);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                document.getElementById('default-service-enabled').checked = deviceConfig.default_service_enabled !== false;
                document.getElementById('monitoring-enabled').checked = deviceConfig.monitoring_enabled !== false;
                
                log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤: ${Object.keys(devices).length}`);
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤: ${error.message}`);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        function updateDeviceStats(stats) {
            document.getElementById('total-devices').textContent = stats.total_devices || 0;
            document.getElementById('online-devices').textContent = stats.online_devices || 0;
            document.getElementById('enabled-devices').textContent = stats.enabled_devices || 0;
            document.getElementById('disabled-devices').textContent = stats.disabled_devices || 0;
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        function displayDeviceList(devices, config) {
            const deviceListElement = document.getElementById('device-list');
            
            if (Object.keys(devices).length === 0) {
                deviceListElement.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            let html = '';
            for (const [deviceId, device] of Object.entries(devices)) {
                if (deviceId.startsWith('_')) continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã
                
                const isOnline = device.is_online || false;
                const serviceEnabled = device.service_enabled !== false;
                const lastSeen = device.last_seen ? new Date(device.last_seen).toLocaleString('ru-RU') : '–ù–∏–∫–æ–≥–¥–∞';
                
                html += `
                    <div class="device-card">
                        <div class="device-header">
                            <div class="device-name">${device.device_name || deviceId}</div>
                            <div class="device-status ${isOnline ? 'online' : 'offline'}">
                                ${isOnline ? 'üü¢ –û–Ω–ª–∞–π–Ω' : 'üî¥ –û—Ñ–ª–∞–π–Ω'}
                            </div>
                        </div>
                        <div class="device-details">
                            <div><strong>ID:</strong> ${deviceId}</div>
                            <div><strong>–ú–æ–¥–µ–ª—å:</strong> ${device.model || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                            <div><strong>Android:</strong> ${device.android_version || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                            <div><strong>–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</strong> ${device.app_version || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                            <div><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> ${lastSeen}</div>
                            <div><strong>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:</strong> ${device.registered_at ? new Date(device.registered_at).toLocaleString('ru-RU') : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                        </div>
                        ${device.notes ? `<div style="margin: 10px 0; padding: 8px; background: #f8f9fa; border-radius: 4px; font-style: italic;">${device.notes}</div>` : ''}
                        <div class="device-actions">
                            <button class="device-toggle ${serviceEnabled ? 'enabled' : 'disabled'}" 
                                    onclick="toggleDeviceService('${deviceId}', ${!serviceEnabled})">
                                ${serviceEnabled ? 'üü¢ –û—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å' : 'üî¥ –í–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å'}
                            </button>
                            <button class="btn" onclick="editDeviceNotes('${deviceId}', '${(device.notes || '').replace(/'/g, "\\'")}')">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–º–µ—Ç–∫–∏
                            </button>
                        </div>
                    </div>
                `;
            }
            
            deviceListElement.innerHTML = html;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        async function toggleDeviceService(deviceId, enable) {
            try {
                log(`üîÑ ${enable ? '–í–∫–ª—é—á–µ–Ω–∏–µ' : '–û—Ç–∫–ª—é—á–µ–Ω–∏–µ'} —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ${deviceId}...`);
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤
                // –ü–æ–∫–∞ —á—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ workflow
                
                const action = enable ? 'enable' : 'disable';
                log(`‚úÖ –°–µ—Ä–≤–∏—Å ${enable ? '–≤–∫–ª—é—á–µ–Ω' : '–æ—Ç–∫–ª—é—á–µ–Ω'} –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ${deviceId}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                setTimeout(() => loadDeviceList(), 1000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${error.message}`);
            }
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
        function editDeviceNotes(deviceId, currentNotes) {
            const newNotes = prompt('–í–≤–µ–¥–∏—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:', currentNotes);
            if (newNotes !== null) {
                updateDeviceNotes(deviceId, newNotes);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        async function updateDeviceNotes(deviceId, notes) {
            try {
                log(`üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ${deviceId}...`);
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤
                log(`‚úÖ –ó–∞–º–µ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ${deviceId}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                setTimeout(() => loadDeviceList(), 1000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–æ–∫: ${error.message}`);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        async function updateDeviceGlobalSettings() {
            try {
                log('‚öôÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤...');
                
                const defaultServiceEnabled = document.getElementById('default-service-enabled').checked;
                const monitoringEnabled = document.getElementById('monitoring-enabled').checked;
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                
                log(`‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
                     - –°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ${defaultServiceEnabled}
                     - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∫–ª—é—á–µ–Ω: ${monitoringEnabled}`);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫: ${error.message}`);
            }
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ mapping –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º channel logo mapping –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
            loadChannelLogoMapping();
        });



    </script>
    </div> <!-- –ó–∞–∫—Ä—ã—Ç–∏–µ main-content -->
</body>
</html> 

